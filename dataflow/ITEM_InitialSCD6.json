{
	"name": "ITEM_InitialSCD6",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ItemZone1",
						"type": "DatasetReference"
					},
					"name": "ITEMParquetSCD"
				},
				{
					"dataset": {
						"referenceName": "ItemZone3TGT",
						"type": "DatasetReference"
					},
					"name": "ITEMDIM"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ItemTempZone3",
						"type": "DatasetReference"
					},
					"name": "sinkNew"
				},
				{
					"dataset": {
						"referenceName": "ItemTempZone3",
						"type": "DatasetReference"
					},
					"name": "sinkExpiry"
				},
				{
					"dataset": {
						"referenceName": "ItemTempZone3",
						"type": "DatasetReference"
					},
					"name": "sinkNoChange"
				},
				{
					"dataset": {
						"referenceName": "ItemTempZone3",
						"type": "DatasetReference"
					},
					"name": "sinkSCD2"
				}
			],
			"transformations": [
				{
					"name": "SelectTGT"
				},
				{
					"name": "DerivedColumnCRCVAL"
				},
				{
					"name": "AGGMAXVAL"
				},
				{
					"name": "JoinSRCMaxTGTKey"
				},
				{
					"name": "FindNewUpdateDeleteRecords"
				},
				{
					"name": "CreateSurrogateKey"
				},
				{
					"name": "NewChange"
				},
				{
					"name": "DerivedColumnSurrogateKey"
				},
				{
					"name": "Expiry"
				},
				{
					"name": "JoinSrcTgt"
				},
				{
					"name": "DerivedSCD2"
				},
				{
					"name": "UnionExpiry"
				},
				{
					"name": "DerivedColumn2"
				},
				{
					"name": "DerivedColumn3"
				},
				{
					"name": "SortSrcID"
				}
			],
			"script": "source(output(\n\t\tID as long,\n\t\tLEGACY_ITEM_CODE as integer,\n\t\tVARIANT_ID as integer,\n\t\tVARIANT_NAME as string,\n\t\tVARIANT as string,\n\t\tCHINESE_VARIANT as string,\n\t\tCHINESE_VARIANT_NAME as string,\n\t\tLEAD_VARIANT_INDICATOR as integer,\n\t\tLEAD_RETAIL_VARIANT as integer,\n\t\tRETAIL_SIZE as string,\n\t\tRETAIL_WEIGHT as float,\n\t\tRETAIL_PACK as integer,\n\t\tPRODUCT_STATUS as integer,\n\t\tOPTION_CODE as string,\n\t\tTAX_CODE as integer,\n\t\tFINANCIAL_SALE_FLAG as string,\n\t\tMERCH_SALES_FLAG as string,\n\t\tSTIT as string,\n\t\tDPACK as string,\n\t\tBASKET_TYPE as string,\n\t\tSTRATEGIC_GROUP as string,\n\t\tSELL_UNITS as float,\n\t\tAMP_FORECAST_ITEM as string,\n\t\tREPACK_FLAG as string,\n\t\tLAST_WEEK_AD_TYPE as string,\n\t\tSTORE_REPORT as string,\n\t\tDEPARTMENT_ID as integer,\n\t\tDEPARTMENT_NAME as string,\n\t\tMERCH_DEPARTMENT_ID as integer,\n\t\tMERCH_DEPARTMENT as string,\n\t\tGL_DEPARTMENT_ID as integer,\n\t\tGL_DEPARTMENT_NAME as string,\n\t\tCONS_GL_DEPARTMENT_ID as integer,\n\t\tCONS_GL_DEPARTMENT as string,\n\t\tCONS_GL_DEPARTMENT_NAME as string,\n\t\tCONS_DEPARTMENT as string,\n\t\tHIGH_LEVEL_DEPARTMENT as string,\n\t\tCLASS_CAT_ID as string,\n\t\tCLASS_CAT as string,\n\t\tCATEGORY_ID as string,\n\t\tCATEGORY as string,\n\t\tNEW_CLASS as string,\n\t\tNEW_CLASS_CATEGORY as string,\n\t\tNEW_CLASS_SUBCATEGORY as string,\n\t\tFAMILY_CODE as string,\n\t\tFAMILY_NAME as string,\n\t\tFAMILY_ID as string,\n\t\tFAMILY as string,\n\t\tVENDOR_ID as string,\n\t\tBRAND_NAME as string,\n\t\tAP_VENDOR_ID as string,\n\t\tAP_VENDOR_NAME as string,\n\t\tAP_VENDOR as string,\n\t\tAP_VENDOR_ADDRESS_LINE_1 as string,\n\t\tAP_VENDOR_ADDRESS_LINE_2 as string,\n\t\tAP_VENDOR_CITY as string,\n\t\tAP_VENDOR_PROVINCE as string,\n\t\tCORP_BRAND_DESCRIPTION as string,\n\t\tCORP_BRAND_SHORT_DESCRIPTION as string,\n\t\tCORP_BRAND_INDICATOR as string,\n\t\tCORP_BRAND_VARIANT_CODE as string,\n\t\tCORP_BRAND_SHIELD as string,\n\t\tCORP_BRAND_VARIANT as string,\n\t\tCORP_BRAND_VARIANT_NAME as string,\n\t\tDAYMON as string,\n\t\tMERCHANDISER_NAME as string,\n\t\tMERCHANDISER_NUMBER as string,\n\t\tMERCHANDISER as string,\n\t\tSCPM as string,\n\t\tGENERAL_MANAGER as string,\n\t\tVICE_PRESIDENT as string,\n\t\tCB_DIRECTOR as string,\n\t\tBUSINESS_DEVELOPMENT_MANAGER as string,\n\t\tLISTING_DATE as string,\n\t\tLISTING_WEEK as string,\n\t\tLISTING_PERIOD as string,\n\t\tLISTING_YEAR as string,\n\t\tDISCONTINUE_DATE as string,\n\t\tDISCONTINUE_WEEK as string,\n\t\tDISCONTINUE_PERIOD as string,\n\t\tDISCONTINUE_YEAR as string,\n\t\tDISCONTINUE_REASON as string,\n\t\tFAMILY_START_DATE as string,\n\t\tFAMILY_END_DATE as string,\n\t\tFAMILY_START_WEEK as string,\n\t\tFAMILY_START_PERIOD as string,\n\t\tFAMILY_START_YEAR as string,\n\t\tFAMILY_END_WEEK as string,\n\t\tFAMILY_END_PERIOD as string,\n\t\tFAMILY_END_YEAR as string,\n\t\tSA_DEPT_ID as string,\n\t\tSA_MERCHANDISER_NUMBER as string,\n\t\tSOURCE_SYSTEM_CODE as string,\n\t\tLAST_CHANGED as string,\n\t\tLAST_DML as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> ITEMParquetSCD\nsource(output(\n\t\tItem_Surrogate_Id as long,\n\t\tID as long,\n\t\tLegacy_Item_Code as integer,\n\t\tCurrent_Legacy_Item_Code as integer,\n\t\tVariant_Id as integer,\n\t\tCurrent_Variant_Id as integer,\n\t\tVariant_Name as string,\n\t\tCurrent_Variant_Name as string,\n\t\tVariant as string,\n\t\tCurrent_Variant as string,\n\t\tChinese_Variant as string,\n\t\tCurrent_Chinese_Variant as string,\n\t\tChinese_Variant_Name as string,\n\t\tCurrent_Chinese_Variant_Name as string,\n\t\tLead_Variant_Indicator as integer,\n\t\tCurrent_Lead_Variant_Indicator as integer,\n\t\tLead_Retail_Variant as integer,\n\t\tCurrent_Lead_Retail_Variant as integer,\n\t\tRetail_Size as string,\n\t\tCurrent_Retail_Size as string,\n\t\tRetail_Weight as double,\n\t\tCurrent_Retail_Weight as double,\n\t\tRetail_Pack as integer,\n\t\tCurrent_Retail_Pack as integer,\n\t\tProduct_Status as integer,\n\t\tCurrent_Product_Status as integer,\n\t\tOption_Code as integer,\n\t\tCurrent_Option_Code as integer,\n\t\tTax_Code as integer,\n\t\tCurrent_Tax_Code as integer,\n\t\tFinancial_Sale_Flag as string,\n\t\tCurrent_Financial_Sale_Flag as string,\n\t\tMerch_Sales_Flag as string,\n\t\tCurrent_Merch_Sales_Flag as string,\n\t\tStit as string,\n\t\tCurrent_Stit as string,\n\t\tDPack as string,\n\t\tCurrent_DPack as string,\n\t\tBasket_Type as string,\n\t\tCurrent_Basket_Type as string,\n\t\tStrategic_Group as string,\n\t\tCurrent_Strategic_Group as string,\n\t\tSell_Units as double,\n\t\tCurrent_Sell_Units as double,\n\t\tAmp_Forecast_Item as string,\n\t\tCurrent_Amp_Forecast_Item as string,\n\t\tRepack_Flag as string,\n\t\tCurrent_Repack_Flag as string,\n\t\tLast_Week_Ad_Type as string,\n\t\tCurrent_Last_Week_Ad_Type as string,\n\t\tStore_Report as string,\n\t\tCurrent_Store_Report as string,\n\t\tDepartment_Id as integer,\n\t\tCurrent_Department_Id as integer,\n\t\tDepartment_Name as string,\n\t\tCurrent_Department_Name as string,\n\t\tMerch_Department_Id as integer,\n\t\tCurrent_Merch_Department_Id as integer,\n\t\tMerch_Department as string,\n\t\tCurrent_Merch_Department as string,\n\t\tGL_Department_Id as integer,\n\t\tCurrent_GL_Department_Id as integer,\n\t\tGL_Department_Name as string,\n\t\tCurrent_GL_Department_Name as string,\n\t\tCons_GL_Department_Id as integer,\n\t\tCurrent_Cons_GL_Department_Id as integer,\n\t\tCons_GL_Department as string,\n\t\tCurrent_Cons_GL_Department as string,\n\t\tCons_GL_Department_Name as string,\n\t\tCurrent_Cons_GL_Department_Name as string,\n\t\tCons_Department as string,\n\t\tCurrent_Cons_Department as string,\n\t\tHigh_Level_Department as string,\n\t\tCurrent_High_Level_Department as string,\n\t\tClass_Cat as string,\n\t\tCurrent_Class_Cat as string,\n\t\tClass as string,\n\t\tCurrent_Class as string,\n\t\tCategory_Id as integer,\n\t\tCurrent_Category_Id as integer,\n\t\tCategory as string,\n\t\tCurrent_Category as string,\n\t\tNew_Class as string,\n\t\tCurrent_New_Class as string,\n\t\tNew_Class_Category as string,\n\t\tCurrent_New_Class_Category as string,\n\t\tNew_Class_Subcategory as string,\n\t\tCurrent_New_Class_Subcategory as string,\n\t\tFamily_Code as string,\n\t\tCurrent_Family_Code as string,\n\t\tFamily_Name as string,\n\t\tCurrent_Family_Name as string,\n\t\tFamily_Id as integer,\n\t\tCurrent_Family_Id as integer,\n\t\tFamily as string,\n\t\tCurrent_Family as string,\n\t\tVendor_Id as string,\n\t\tCurrent_Vendor_Id as string,\n\t\tBrand_Name as string,\n\t\tCurrent_Brand_Name as string,\n\t\tAP_Vendor_Id as string,\n\t\tCurrent_AP_Vendor_Id as string,\n\t\tAP_Vendor_Name as string,\n\t\tCurrent_AP_Vendor_Name as string,\n\t\tAP_Vendor as string,\n\t\tCurrent_AP_Vendor as string,\n\t\tAP_Vendor_Address_Line_1 as string,\n\t\tCurrent_AP_Vendor_Address_Line_1 as string,\n\t\tAP_Vendor_Address_Line_2 as string,\n\t\tCurrent_AP_Vendor_Address_Line_2 as string,\n\t\tAP_Vendor_City as string,\n\t\tCurrent_AP_Vendor_City as string,\n\t\tAP_Vendor_Province as string,\n\t\tCurrent_AP_Vendor_Province as string,\n\t\tCorp_Brand_Description as string,\n\t\tCurrent_Corp_Brand_Description as string,\n\t\tCorp_Brand_Short_Description as string,\n\t\tCurrent_Corp_Brand_Short_Description as string,\n\t\tCorp_Brand_Indicator as string,\n\t\tCurrent_Corp_Brand_Indicator as string,\n\t\tCorp_Brand_Variant_Code as string,\n\t\tCurrent_Corp_Brand_Variant_Code as string,\n\t\tCorp_Brand_Shield as string,\n\t\tCurrent_Corp_Brand_Shield as string,\n\t\tCorp_Brand_Variant as string,\n\t\tCurrent_Corp_Brand_Variant as string,\n\t\tCorp_Brand_Variant_Name as string,\n\t\tCurrent_Corp_Brand_Variant_Name as string,\n\t\tDaymon as string,\n\t\tCurrent_Daymon as string,\n\t\tMerchandiser_Name as string,\n\t\tCurrent_Merchandiser_Name as string,\n\t\tMerchandiser_Number as string,\n\t\tCurrent_Merchandiser_Number as string,\n\t\tMerchandiser as string,\n\t\tCurrent_Merchandiser as string,\n\t\tSCPM as string,\n\t\tCurrent_SCPM as string,\n\t\tGeneral_Manager as string,\n\t\tCurrent_General_Manager as string,\n\t\tVice_President as string,\n\t\tCurrent_Vice_President as string,\n\t\tCB_Director as string,\n\t\tCurrent_CB_Director as string,\n\t\tBusiness_Development_Manager as string,\n\t\tCurrent_Business_Development_Manager as string,\n\t\tListing_Date as date,\n\t\tCurrent_Listing_Date as date,\n\t\tDiscontinue_Date as string,\n\t\tCurrent_Discontinue_Date as string,\n\t\tDiscontinue_Reason as string,\n\t\tCurrent_Discontinue_Reason as string,\n\t\tFamily_Start_Date as date,\n\t\tCurrent_Family_Start_Date as date,\n\t\tFamily_End_Date as date,\n\t\tCurrent_Family_End_Date as date,\n\t\tSource_System_Code as string,\n\t\tCurrent_Source_System_Code as string,\n\t\tEff_Start_Dt as date,\n\t\tEff_End_Dt as date,\n\t\tIsActive as integer,\n\t\tCrc_Val as string,\n\t\tLast_Changed as string,\n\t\tLast_Dml as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet') ~> ITEMDIM\nITEMDIM select(mapColumn(\n\t\tTGT_Item_Surrogate_ID = Item_Surrogate_Id,\n\t\tTGT_ID = ID,\n\t\tTGT_LEGACY_ITEM_CODE = Legacy_Item_Code,\n\t\tTGT_Current_LEGACY_ITEM_CODE = Current_Legacy_Item_Code,\n\t\tTGT_VARIANT_ID = Variant_Id,\n\t\tTGT_Current_VARIANT_ID = Current_Variant_Id,\n\t\tTGT_VARIANT_NAME = Variant_Name,\n\t\tTGT_Current_VARIANT_NAME = Current_Variant_Name,\n\t\tTGT_VARIANT = Variant,\n\t\tTGT_Current_VARIANT = Current_Variant,\n\t\tTGT_CHINESE_VARIANT = Chinese_Variant,\n\t\tTGT_Current_CHINESE_VARIANT = Current_Chinese_Variant,\n\t\tTGT_CHINESE_VARIANT_NAME = Chinese_Variant_Name,\n\t\tTGT_Current_CHINESE_VARIANT_NAME = Current_Chinese_Variant_Name,\n\t\tTGT_LEAD_VARIANT_INDICATOR = Lead_Variant_Indicator,\n\t\tTGT_Current_LEAD_VARIANT_INDICATOR = Current_Lead_Variant_Indicator,\n\t\tTGT_LEAD_RETAIL_VARIANT = Lead_Retail_Variant,\n\t\tTGT_Current_LEAD_RETAIL_VARIANT = Current_Lead_Retail_Variant,\n\t\tTGT_RETAIL_SIZE = Retail_Size,\n\t\tTGT_Current_RETAIL_SIZE = Current_Retail_Size,\n\t\tTGT_RETAIL_WEIGHT = Retail_Weight,\n\t\tTGT_Current_RETAIL_WEIGHT = Current_Retail_Weight,\n\t\tTGT_RETAIL_PACK = Retail_Pack,\n\t\tTGT_Current_RETAIL_PACK = Current_Retail_Pack,\n\t\tTGT_PRODUCT_STATUS = Product_Status,\n\t\tTGT_Current_PRODUCT_STATUS = Current_Product_Status,\n\t\tTGT_OPTION_CODE = Option_Code,\n\t\tTGT_Current_OPTION_CODE = Current_Option_Code,\n\t\tTGT_TAX_CODE = Tax_Code,\n\t\tTGT_Current_TAX_CODE = Current_Tax_Code,\n\t\tTGT_FINANCIAL_SALE_FLAG = Financial_Sale_Flag,\n\t\tTGT_Current_FINANCIAL_SALE_FLAG = Current_Financial_Sale_Flag,\n\t\tTGT_MERCH_SALES_FLAG = Merch_Sales_Flag,\n\t\tTGT_Current_MERCH_SALES_FLAG = Current_Merch_Sales_Flag,\n\t\tTGT_STIT = Stit,\n\t\tTGT_Current_STIT = Current_Stit,\n\t\tTGT_DPACK = DPack,\n\t\tTGT_Current_DPACK = Current_DPack,\n\t\tTGT_BASKET_TYPE = Basket_Type,\n\t\tTGT_Current_BASKET_TYPE = Current_Basket_Type,\n\t\tTGT_STRATEGIC_GROUP = Strategic_Group,\n\t\tTGT_Current_STRATEGIC_GROUP = Current_Strategic_Group,\n\t\tTGT_SELL_UNITS = Sell_Units,\n\t\tTGT_Current_SELL_UNITS = Current_Sell_Units,\n\t\tTGT_AMP_FORECAST_ITEM = Amp_Forecast_Item,\n\t\tTGT_Current_AMP_FORECAST_ITEM = Current_Amp_Forecast_Item,\n\t\tTGT_REPACK_FLAG = Repack_Flag,\n\t\tTGT_Current_REPACK_FLAG = Current_Repack_Flag,\n\t\tTGT_LAST_WEEK_AD_TYPE = Last_Week_Ad_Type,\n\t\tTGT_Current_LAST_WEEK_AD_TYPE = Current_Last_Week_Ad_Type,\n\t\tTGT_STORE_REPORT = Store_Report,\n\t\tTGT_Current_STORE_REPORT = Current_Store_Report,\n\t\tTGT_DEPARTMENT_ID = Department_Id,\n\t\tTGT_Current_DEPARTMENT_ID = Current_Department_Id,\n\t\tTGT_DEPARTMENT_NAME = Department_Name,\n\t\tTGT_Current_DEPARTMENT_NAME = Current_Department_Name,\n\t\tTGT_MERCH_DEPARTMENT_ID = Merch_Department_Id,\n\t\tTGT_Current_MERCH_DEPARTMENT_ID = Current_Merch_Department_Id,\n\t\tTGT_MERCH_DEPARTMENT = Merch_Department,\n\t\tTGT_Current_MERCH_DEPARTMENT = Current_Merch_Department,\n\t\tTGT_GL_DEPARTMENT_ID = GL_Department_Id,\n\t\tTGT_Current_GL_DEPARTMENT_ID = Current_GL_Department_Id,\n\t\tTGT_GL_DEPARTMENT_NAME = GL_Department_Name,\n\t\tTGT_Current_GL_DEPARTMENT_NAME = Current_GL_Department_Name,\n\t\tTGT_CONS_GL_DEPARTMENT_ID = Cons_GL_Department_Id,\n\t\tTGT_Current_CONS_GL_DEPARTMENT_ID = Current_Cons_GL_Department_Id,\n\t\tTGT_CONS_GL_DEPARTMENT = Cons_GL_Department,\n\t\tTGT_Current_CONS_GL_DEPARTMENT = Current_Cons_GL_Department,\n\t\tTGT_CONS_GL_DEPARTMENT_NAME = Cons_GL_Department_Name,\n\t\tTGT_Current_CONS_GL_DEPARTMENT_NAME = Current_Cons_GL_Department_Name,\n\t\tTGT_CONS_DEPARTMENT = Cons_Department,\n\t\tTGT_Current_CONS_DEPARTMENT = Current_Cons_Department,\n\t\tTGT_HIGH_LEVEL_DEPARTMENT = High_Level_Department,\n\t\tTGT_Current_HIGH_LEVEL_DEPARTMENT = Current_High_Level_Department,\n\t\tTGT_CLASS_CAT_ID = Class_Cat,\n\t\tTGT_Current_CLASS_CAT_ID = Current_Class_Cat,\n\t\tTGT_CLASS_CAT = Class,\n\t\tTGT_Current_CLASS_CAT = Current_Class,\n\t\tTGT_CATEGORY_ID = Category_Id,\n\t\tTGT_Current_CATEGORY_ID = Current_Category_Id,\n\t\tTGT_CATEGORY = Category,\n\t\tTGT_Current_CATEGORY = Current_Category,\n\t\tTGT_NEW_CLASS = New_Class,\n\t\tTGT_Current_CNEW_CLASS = Current_New_Class,\n\t\tTGT_NEW_CLASS_CATEGORY = New_Class_Category,\n\t\tTGT_Current_NEW_CLASS_CATEGORY = Current_New_Class_Category,\n\t\tTGT_NEW_CLASS_SUBCATEGORY = New_Class_Subcategory,\n\t\tTGT_Current_NEW_CLASS_SUBCATEGORY = Current_New_Class_Subcategory,\n\t\tTGT_FAMILY_CODE = Family_Code,\n\t\tTGT_Current_FAMILY_CODE = Current_Family_Code,\n\t\tTGT_FAMILY_NAME = Family_Name,\n\t\tTGT_Current_FAMILY_NAME = Current_Family_Name,\n\t\tTGT_FAMILY_ID = Family_Id,\n\t\tTGT_Current_FAMILY_ID = Current_Family_Id,\n\t\tTGT_FAMILY = Family,\n\t\tTGT_Current_FAMILY = Current_Family,\n\t\tTGT_VENDOR_ID = Vendor_Id,\n\t\tTGT_Current_VENDOR_ID = Current_Vendor_Id,\n\t\tTGT_BRAND_NAME = Brand_Name,\n\t\tTGT_Current_BRAND_NAME = Current_Brand_Name,\n\t\tTGT_AP_VENDOR_ID = AP_Vendor_Id,\n\t\tTGT_Current_AP_VENDOR_ID = Current_AP_Vendor_Id,\n\t\tTGT_AP_VENDOR_NAME = AP_Vendor_Name,\n\t\tTGT_Current_AP_VENDOR_NAME = Current_AP_Vendor_Name,\n\t\tTGT_AP_VENDOR = AP_Vendor,\n\t\tTGT_Current_AP_VENDOR = Current_AP_Vendor,\n\t\tTGT_AP_VENDOR_ADDRESS_LINE_1 = AP_Vendor_Address_Line_1,\n\t\tTGT_Current_AP_VENDOR_ADDRESS_LINE_1 = Current_AP_Vendor_Address_Line_1,\n\t\tTGT_AP_VENDOR_ADDRESS_LINE_2 = AP_Vendor_Address_Line_2,\n\t\tTGT_Current_AP_VENDOR_ADDRESS_LINE_2 = Current_AP_Vendor_Address_Line_2,\n\t\tTGT_AP_VENDOR_CITY = AP_Vendor_City,\n\t\tTGT_Current_AP_VENDOR_CITY = Current_AP_Vendor_City,\n\t\tTGT_AP_VENDOR_PROVINCE = AP_Vendor_Province,\n\t\tTGT_Current_AP_VENDOR_PROVINCE = Current_AP_Vendor_Province,\n\t\tTGT_CORP_BRAND_DESCRIPTION = Corp_Brand_Description,\n\t\tTGT_Current_CORP_BRAND_DESCRIPTION = Current_Corp_Brand_Description,\n\t\tTGT_CORP_BRAND_SHORT_DESCRIPTION = Corp_Brand_Short_Description,\n\t\tTGT_Current_CORP_BRAND_SHORT_DESCRIPTION = Current_Corp_Brand_Short_Description,\n\t\tTGT_CORP_BRAND_INDICATOR = Corp_Brand_Indicator,\n\t\tTGT_Current_CORP_BRAND_INDICATOR = Current_Corp_Brand_Indicator,\n\t\tTGT_CORP_BRAND_VARIANT_CODE = Corp_Brand_Variant_Code,\n\t\tTGT_Current_CORP_BRAND_VARIANT_CODE = Current_Corp_Brand_Variant_Code,\n\t\tTGT_CORP_BRAND_SHIELD = Corp_Brand_Shield,\n\t\tTGT_Current_CORP_BRAND_SHIELD = Current_Corp_Brand_Shield,\n\t\tTGT_CORP_BRAND_VARIANT = Corp_Brand_Variant,\n\t\tTGT_Current_CORP_BRAND_VARIANT = Current_Corp_Brand_Variant,\n\t\tTGT_CORP_BRAND_VARIANT_NAME = Corp_Brand_Variant_Name,\n\t\tTGT_Current_CORP_BRAND_VARIANT_NAME = Current_Corp_Brand_Variant_Name,\n\t\tTGT_DAYMON = Daymon,\n\t\tTGT_Current_DAYMON = Current_Daymon,\n\t\tTGT_MERCHANDISER_NAME = Merchandiser_Name,\n\t\tTGT_Current_MERCHANDISER_NAME = Current_Merchandiser_Name,\n\t\tTGT_MERCHANDISER_NUMBER = Merchandiser_Number,\n\t\tTGT_Current_MERCHANDISER_NUMBER = Current_Merchandiser_Number,\n\t\tTGT_MERCHANDISER = Merchandiser,\n\t\tTGT_Current_MERCHANDISER = Current_Merchandiser,\n\t\tTGT_SCPM = SCPM,\n\t\tTGT_Current_SCPM = Current_SCPM,\n\t\tTGT_GENERAL_MANAGER = General_Manager,\n\t\tTGT_Current_GENERAL_MANAGER = Current_General_Manager,\n\t\tTGT_VICE_PRESIDENT = Vice_President,\n\t\tTGT_Current_VICE_PRESIDENT = Current_Vice_President,\n\t\tTGT_CB_DIRECTOR = CB_Director,\n\t\tTGT_Current_CB_DIRECTOR = Current_CB_Director,\n\t\tTGT_BUSINESS_DEVELOPMENT_MANAGER = Business_Development_Manager,\n\t\tTGT_Current_BUSINESS_DEVELOPMENT_MANAGER = Current_Business_Development_Manager,\n\t\tTGT_LISTING_DATE = Listing_Date,\n\t\tTGT_Current_LISTING_DATE = Current_Listing_Date,\n\t\tTGT_DISCONTINUE_DATE = Discontinue_Date,\n\t\tTGT_Current_DISCONTINUE_DATE = Current_Discontinue_Date,\n\t\tTGT_DISCONTINUE_REASON = Discontinue_Reason,\n\t\tTGT_Current_DISCONTINUE_REASON = Current_Discontinue_Reason,\n\t\tTGT_FAMILY_START_DATE = Family_Start_Date,\n\t\tTGT_Current_FAMILY_START_DATE = Current_Family_Start_Date,\n\t\tTGT_FAMILY_END_DATE = Family_End_Date,\n\t\tTGT_Current_FAMILY_END_DATE = Current_Family_End_Date,\n\t\tTGT_SOURCE_SYSTEM_CODE = Source_System_Code,\n\t\tTGT_Current_SOURCE_SYSTEM_CODE = Current_Source_System_Code,\n\t\tTGT_EFF_START_DT = Eff_Start_Dt,\n\t\tTGT_EFF_END_DT = Eff_End_Dt,\n\t\tTGT_IsActive = IsActive,\n\t\tTGT_CRC_VAL = Crc_Val,\n\t\tTGT_LAST_CHANGED = Last_Changed,\n\t\tTGT_LAST_DML = Last_Dml\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectTGT\nSortSrcID derive(IsActive = 1,\n\t\tEFF_START_DT = toDate('1900-01-01'),\n\t\tEFF_END_DT = toDate('9999-12-31'),\n\t\tCRCVAL = case(isNull(ID),TGT_CRC_VAL,md5(LEGACY_ITEM_CODE,VARIANT_ID,VARIANT_NAME,VARIANT,CHINESE_VARIANT,CHINESE_VARIANT_NAME,LEAD_VARIANT_INDICATOR,LEAD_RETAIL_VARIANT,RETAIL_SIZE,RETAIL_WEIGHT,RETAIL_PACK,PRODUCT_STATUS,OPTION_CODE,TAX_CODE,FINANCIAL_SALE_FLAG,MERCH_SALES_FLAG,STIT,DPACK,BASKET_TYPE,STRATEGIC_GROUP,SELL_UNITS,AMP_FORECAST_ITEM,REPACK_FLAG,LAST_WEEK_AD_TYPE,STORE_REPORT,DEPARTMENT_ID,DEPARTMENT_NAME,MERCH_DEPARTMENT_ID,MERCH_DEPARTMENT,GL_DEPARTMENT_ID,GL_DEPARTMENT_NAME,CONS_GL_DEPARTMENT_ID,CONS_GL_DEPARTMENT,CONS_GL_DEPARTMENT_NAME,CONS_DEPARTMENT,HIGH_LEVEL_DEPARTMENT,CLASS_CAT_ID,CLASS_CAT,CATEGORY_ID,CATEGORY,NEW_CLASS,NEW_CLASS_CATEGORY,NEW_CLASS_SUBCATEGORY,FAMILY_CODE,FAMILY_NAME,FAMILY_ID,FAMILY,VENDOR_ID,BRAND_NAME,AP_VENDOR_ID,AP_VENDOR_NAME,AP_VENDOR,AP_VENDOR_ADDRESS_LINE_1,AP_VENDOR_ADDRESS_LINE_2,AP_VENDOR_CITY,AP_VENDOR_PROVINCE,CORP_BRAND_DESCRIPTION,CORP_BRAND_SHORT_DESCRIPTION,CORP_BRAND_INDICATOR,CORP_BRAND_VARIANT_CODE,CORP_BRAND_SHIELD,CORP_BRAND_VARIANT,CORP_BRAND_VARIANT_NAME,DAYMON,MERCHANDISER_NAME,MERCHANDISER_NUMBER,MERCHANDISER,SCPM,GENERAL_MANAGER,VICE_PRESIDENT,CB_DIRECTOR,BUSINESS_DEVELOPMENT_MANAGER,LISTING_DATE,LISTING_WEEK,LISTING_PERIOD,LISTING_YEAR,DISCONTINUE_DATE,DISCONTINUE_WEEK,DISCONTINUE_PERIOD,DISCONTINUE_YEAR,DISCONTINUE_REASON,FAMILY_START_DATE,FAMILY_END_DATE,FAMILY_START_WEEK,FAMILY_START_PERIOD,FAMILY_START_YEAR,FAMILY_END_WEEK,FAMILY_END_PERIOD,FAMILY_END_YEAR,SA_DEPT_ID,SA_MERCHANDISER_NUMBER,SOURCE_SYSTEM_CODE))) ~> DerivedColumnCRCVAL\nSelectTGT aggregate(MAXVAL = max(TGT_Item_Surrogate_ID)) ~> AGGMAXVAL\nITEMParquetSCD, AGGMAXVAL join(1 == 1,\n\tjoinType:'cross',\n\tbroadcast: 'auto')~> JoinSRCMaxTGTKey\nDerivedColumnCRCVAL split((isNull(TGT_Item_Surrogate_ID)  && toDouble(LAST_DML)>=0) || (not(isNull(TGT_Item_Surrogate_ID)) && CRCVAL != TGT_CRC_VAL  && IsActive==1 ),\n\t(not(isNull(TGT_Item_Surrogate_ID)) && CRCVAL == TGT_CRC_VAL) && IsActive == 1,\n\tnot(isNull(TGT_Item_Surrogate_ID)) && toDouble(LAST_DML) < 0,\n\tdisjoint: false,\n\tpartitionBy('hash', 1)) ~> FindNewUpdateDeleteRecords@(SurrogateKey, NoSurrogateKey, Delete)\nFindNewUpdateDeleteRecords@SurrogateKey keyGenerate(output(SurrogateKey as long),\n\tstartAt: 1L) ~> CreateSurrogateKey\nDerivedColumnSurrogateKey split(isNull(TGT_Item_Surrogate_ID)  && toDouble(LAST_DML)>=0,\n\tnot(isNull(TGT_Item_Surrogate_ID)) && CRCVAL != TGT_CRC_VAL  && toDouble(LAST_DML)>=0 && TGT_IsActive == 1,\n\tnot(isNull(TGT_Item_Surrogate_ID)) && CRCVAL != TGT_CRC_VAL  && toDouble(LAST_DML)>=0 && TGT_IsActive == 0,\n\tdisjoint: false) ~> NewChange@(NewRecords, SCD2, SCDExpiry)\nCreateSurrogateKey derive(out_SurrogateKey = toInteger(SurrogateKey) + iifNull(MAXVAL,0,MAXVAL),\n\t\to_Listing_Date = case(isNull(LISTING_DATE),toDate(LISTING_DATE,'MM/dd/yyyy'),\r\ncase (length(LISTING_DATE)==10,toDate(LISTING_DATE,'MM/dd/yyyy'), toDate('01/01/9999','MM/dd/yyyy')\r\n)),\n\t\to_Family_Start_Date = case(isNull(FAMILY_START_DATE),toDate(FAMILY_START_DATE,'MM/dd/yyyy'),\r\ncase (length(FAMILY_START_DATE)==10,toDate(FAMILY_START_DATE,'MM/dd/yyyy'), toDate('01/01/9999','MM/dd/yyyy')\r\n)),\n\t\to_Family_End_Date = case(isNull(FAMILY_END_DATE),toDate(FAMILY_END_DATE,'MM/dd/yyyy'),\r\ncase (length(FAMILY_END_DATE)==10,toDate(FAMILY_END_DATE,'MM/dd/yyyy'), toDate('01/01/9999','MM/dd/yyyy')\r\n))) ~> DerivedColumnSurrogateKey\nNewChange@SCD2 derive(expiry_EFF_END_DATE = currentDate()) ~> Expiry\nJoinSRCMaxTGTKey, SelectTGT join(ID == TGT_ID,\n\tjoinType:'outer',\n\tbroadcast: 'auto')~> JoinSrcTgt\nNewChange@SCD2 derive(scd_EFF_START_DT = currentDate()) ~> DerivedSCD2\nExpiry, NewChange@SCDExpiry union(byName: true)~> UnionExpiry\nUnionExpiry derive(final_EFF_END_DT = case(TGT_IsActive == 0,TGT_EFF_END_DT,expiry_EFF_END_DATE),\n\t\tfinal_Surrogate_Key = case(TGT_IsActive == 0,TGT_Item_Surrogate_ID,out_SurrogateKey),\n\t\tInactive = 0) ~> DerivedColumn2\nFindNewUpdateDeleteRecords@NoSurrogateKey derive(del_EFF_END_DATE = case(toDouble(LAST_DML)<0 && TGT_EFF_END_DT < currentDate(),TGT_EFF_END_DT,\r\ntoDouble(LAST_DML)<0 && TGT_EFF_END_DT > currentDate(),currentDate()\r\n, TGT_EFF_END_DT),\n\t\tdel_inactive = case(toDouble(LAST_DML)<0,0,TGT_IsActive),\n\t\tdel_LAST_DML = case(toDouble(LAST_DML)<0,toDouble(LAST_DML),toDouble(TGT_LAST_DML))) ~> DerivedColumn3\nJoinSrcTgt sort(asc(ID, false)) ~> SortSrcID\nNewChange@NewRecords sink(allowSchemaDrift: true,\n\tvalidateSchema: true,\n\tinput(\n\t\tItem_Surrogate_Id as long,\n\t\tID as long,\n\t\tLegacy_Item_Code as integer,\n\t\tCurrent_Legacy_Item_Code as integer,\n\t\tVariant_Id as integer,\n\t\tCurrent_Variant_Id as integer,\n\t\tVariant_Name as string,\n\t\tCurrent_Variant_Name as string,\n\t\tVariant as string,\n\t\tCurrent_Variant as string,\n\t\tChinese_Variant as string,\n\t\tCurrent_Chinese_Variant as string,\n\t\tChinese_Variant_Name as string,\n\t\tCurrent_Chinese_Variant_Name as string,\n\t\tLead_Variant_Indicator as integer,\n\t\tCurrent_Lead_Variant_Indicator as integer,\n\t\tLead_Retail_Variant as integer,\n\t\tCurrent_Lead_Retail_Variant as integer,\n\t\tRetail_Size as string,\n\t\tCurrent_Retail_Size as string,\n\t\tRetail_Weight as double,\n\t\tCurrent_Retail_Weight as double,\n\t\tRetail_Pack as integer,\n\t\tCurrent_Retail_Pack as integer,\n\t\tProduct_Status as integer,\n\t\tCurrent_Product_Status as integer,\n\t\tOption_Code as integer,\n\t\tCurrent_Option_Code as integer,\n\t\tTax_Code as integer,\n\t\tCurrent_Tax_Code as integer,\n\t\tFinancial_Sale_Flag as string,\n\t\tCurrent_Financial_Sale_Flag as string,\n\t\tMerch_Sales_Flag as string,\n\t\tCurrent_Merch_Sales_Flag as string,\n\t\tStit as string,\n\t\tCurrent_Stit as string,\n\t\tDPack as string,\n\t\tCurrent_DPack as string,\n\t\tBasket_Type as string,\n\t\tCurrent_Basket_Type as string,\n\t\tStrategic_Group as string,\n\t\tCurrent_Strategic_Group as string,\n\t\tSell_Units as double,\n\t\tCurrent_Sell_Units as double,\n\t\tAmp_Forecast_Item as string,\n\t\tCurrent_Amp_Forecast_Item as string,\n\t\tRepack_Flag as string,\n\t\tCurrent_Repack_Flag as string,\n\t\tLast_Week_Ad_Type as string,\n\t\tCurrent_Last_Week_Ad_Type as string,\n\t\tStore_Report as string,\n\t\tCurrent_Store_Report as string,\n\t\tDepartment_Id as integer,\n\t\tCurrent_Department_Id as integer,\n\t\tDepartment_Name as string,\n\t\tCurrent_Department_Name as string,\n\t\tMerch_Department_Id as integer,\n\t\tCurrent_Merch_Department_Id as integer,\n\t\tMerch_Department as string,\n\t\tCurrent_Merch_Department as string,\n\t\tGL_Department_Id as integer,\n\t\tCurrent_GL_Department_Id as integer,\n\t\tGL_Department_Name as string,\n\t\tCurrent_GL_Department_Name as string,\n\t\tCons_GL_Department_Id as integer,\n\t\tCurrent_Cons_GL_Department_Id as integer,\n\t\tCons_GL_Department as string,\n\t\tCurrent_Cons_GL_Department as string,\n\t\tCons_GL_Department_Name as string,\n\t\tCurrent_Cons_GL_Department_Name as string,\n\t\tCons_Department as string,\n\t\tCurrent_Cons_Department as string,\n\t\tHigh_Level_Department as string,\n\t\tCurrent_High_Level_Department as string,\n\t\tClass_Cat as string,\n\t\tCurrent_Class_Cat as string,\n\t\tClass as string,\n\t\tCurrent_Class as string,\n\t\tCategory_Id as integer,\n\t\tCurrent_Category_Id as integer,\n\t\tCategory as string,\n\t\tCurrent_Category as string,\n\t\tNew_Class as string,\n\t\tCurrent_New_Class as string,\n\t\tNew_Class_Category as string,\n\t\tCurrent_New_Class_Category as string,\n\t\tNew_Class_Subcategory as string,\n\t\tCurrent_New_Class_Subcategory as string,\n\t\tFamily_Code as string,\n\t\tCurrent_Family_Code as string,\n\t\tFamily_Name as string,\n\t\tCurrent_Family_Name as string,\n\t\tFamily_Id as integer,\n\t\tCurrent_Family_Id as integer,\n\t\tFamily as string,\n\t\tCurrent_Family as string,\n\t\tVendor_Id as string,\n\t\tCurrent_Vendor_Id as string,\n\t\tBrand_Name as string,\n\t\tCurrent_Brand_Name as string,\n\t\tAP_Vendor_Id as string,\n\t\tCurrent_AP_Vendor_Id as string,\n\t\tAP_Vendor_Name as string,\n\t\tCurrent_AP_Vendor_Name as string,\n\t\tAP_Vendor as string,\n\t\tCurrent_AP_Vendor as string,\n\t\tAP_Vendor_Address_Line_1 as string,\n\t\tCurrent_AP_Vendor_Address_Line_1 as string,\n\t\tAP_Vendor_Address_Line_2 as string,\n\t\tCurrent_AP_Vendor_Address_Line_2 as string,\n\t\tAP_Vendor_City as string,\n\t\tCurrent_AP_Vendor_City as string,\n\t\tAP_Vendor_Province as string,\n\t\tCurrent_AP_Vendor_Province as string,\n\t\tCorp_Brand_Description as string,\n\t\tCurrent_Corp_Brand_Description as string,\n\t\tCorp_Brand_Short_Description as string,\n\t\tCurrent_Corp_Brand_Short_Description as string,\n\t\tCorp_Brand_Indicator as string,\n\t\tCurrent_Corp_Brand_Indicator as string,\n\t\tCorp_Brand_Variant_Code as string,\n\t\tCurrent_Corp_Brand_Variant_Code as string,\n\t\tCorp_Brand_Shield as string,\n\t\tCurrent_Corp_Brand_Shield as string,\n\t\tCorp_Brand_Variant as string,\n\t\tCurrent_Corp_Brand_Variant as string,\n\t\tCorp_Brand_Variant_Name as string,\n\t\tCurrent_Corp_Brand_Variant_Name as string,\n\t\tDaymon as string,\n\t\tCurrent_Daymon as string,\n\t\tMerchandiser_Name as string,\n\t\tCurrent_Merchandiser_Name as string,\n\t\tMerchandiser_Number as string,\n\t\tCurrent_Merchandiser_Number as string,\n\t\tMerchandiser as string,\n\t\tCurrent_Merchandiser as string,\n\t\tSCPM as string,\n\t\tCurrent_SCPM as string,\n\t\tGeneral_Manager as string,\n\t\tCurrent_General_Manager as string,\n\t\tVice_President as string,\n\t\tCurrent_Vice_President as string,\n\t\tCB_Director as string,\n\t\tCurrent_CB_Director as string,\n\t\tBusiness_Development_Manager as string,\n\t\tCurrent_Business_Development_Manager as string,\n\t\tListing_Date as date,\n\t\tCurrent_Listing_Date as date,\n\t\tDiscontinue_Date as string,\n\t\tCurrent_Discontinue_Date as string,\n\t\tDiscontinue_Reason as string,\n\t\tCurrent_Discontinue_Reason as string,\n\t\tFamily_Start_Date as date,\n\t\tCurrent_Family_Start_Date as date,\n\t\tFamily_End_Date as date,\n\t\tCurrent_Family_End_Date as date,\n\t\tSource_System_Code as string,\n\t\tCurrent_Source_System_Code as string,\n\t\tEff_Start_Dt as date,\n\t\tEff_End_Dt as date,\n\t\tIsActive as integer,\n\t\tCrc_Val as string,\n\t\tLast_Changed as string,\n\t\tLast_Dml as string\n\t),\n\tformat: 'parquet',\n\tpartitionFileNames:['ITEMDIM_New.parquet'],\n\tsaveOrder: 0,\n\tmapColumn(\n\t\tItem_Surrogate_Id = out_SurrogateKey,\n\t\tID,\n\t\tLegacy_Item_Code = LEGACY_ITEM_CODE,\n\t\tCurrent_Legacy_Item_Code = LEGACY_ITEM_CODE,\n\t\tVariant_Id = VARIANT_ID,\n\t\tCurrent_Variant_Id = VARIANT_ID,\n\t\tVariant_Name = VARIANT_NAME,\n\t\tCurrent_Variant_Name = VARIANT_NAME,\n\t\tVariant = VARIANT,\n\t\tCurrent_Variant = VARIANT,\n\t\tChinese_Variant = CHINESE_VARIANT,\n\t\tCurrent_Chinese_Variant = CHINESE_VARIANT,\n\t\tChinese_Variant_Name = CHINESE_VARIANT_NAME,\n\t\tCurrent_Chinese_Variant_Name = CHINESE_VARIANT_NAME,\n\t\tLead_Variant_Indicator = LEAD_VARIANT_INDICATOR,\n\t\tCurrent_Lead_Variant_Indicator = LEAD_VARIANT_INDICATOR,\n\t\tLead_Retail_Variant = LEAD_RETAIL_VARIANT,\n\t\tCurrent_Lead_Retail_Variant = LEAD_RETAIL_VARIANT,\n\t\tRetail_Size = RETAIL_SIZE,\n\t\tCurrent_Retail_Size = RETAIL_SIZE,\n\t\tRetail_Weight = RETAIL_WEIGHT,\n\t\tCurrent_Retail_Weight = RETAIL_WEIGHT,\n\t\tRetail_Pack = RETAIL_PACK,\n\t\tCurrent_Retail_Pack = RETAIL_PACK,\n\t\tProduct_Status = PRODUCT_STATUS,\n\t\tCurrent_Product_Status = PRODUCT_STATUS,\n\t\tOption_Code = OPTION_CODE,\n\t\tCurrent_Option_Code = OPTION_CODE,\n\t\tTax_Code = TAX_CODE,\n\t\tCurrent_Tax_Code = TAX_CODE,\n\t\tFinancial_Sale_Flag = FINANCIAL_SALE_FLAG,\n\t\tCurrent_Financial_Sale_Flag = FINANCIAL_SALE_FLAG,\n\t\tMerch_Sales_Flag = MERCH_SALES_FLAG,\n\t\tCurrent_Merch_Sales_Flag = MERCH_SALES_FLAG,\n\t\tStit = STIT,\n\t\tCurrent_Stit = STIT,\n\t\tDPack = DPACK,\n\t\tCurrent_DPack = DPACK,\n\t\tBasket_Type = BASKET_TYPE,\n\t\tCurrent_Basket_Type = BASKET_TYPE,\n\t\tStrategic_Group = STRATEGIC_GROUP,\n\t\tCurrent_Strategic_Group = STRATEGIC_GROUP,\n\t\tSell_Units = SELL_UNITS,\n\t\tCurrent_Sell_Units = SELL_UNITS,\n\t\tAmp_Forecast_Item = AMP_FORECAST_ITEM,\n\t\tCurrent_Amp_Forecast_Item = AMP_FORECAST_ITEM,\n\t\tRepack_Flag = REPACK_FLAG,\n\t\tCurrent_Repack_Flag = REPACK_FLAG,\n\t\tLast_Week_Ad_Type = LAST_WEEK_AD_TYPE,\n\t\tCurrent_Last_Week_Ad_Type = LAST_WEEK_AD_TYPE,\n\t\tStore_Report = STORE_REPORT,\n\t\tCurrent_Store_Report = STORE_REPORT,\n\t\tDepartment_Id = DEPARTMENT_ID,\n\t\tCurrent_Department_Id = DEPARTMENT_ID,\n\t\tDepartment_Name = DEPARTMENT_NAME,\n\t\tCurrent_Department_Name = DEPARTMENT_NAME,\n\t\tMerch_Department_Id = MERCH_DEPARTMENT_ID,\n\t\tCurrent_Merch_Department_Id = MERCH_DEPARTMENT_ID,\n\t\tMerch_Department = MERCH_DEPARTMENT,\n\t\tCurrent_Merch_Department = MERCH_DEPARTMENT,\n\t\tGL_Department_Id = GL_DEPARTMENT_ID,\n\t\tCurrent_GL_Department_Id = GL_DEPARTMENT_ID,\n\t\tGL_Department_Name = GL_DEPARTMENT_NAME,\n\t\tCurrent_GL_Department_Name = GL_DEPARTMENT_NAME,\n\t\tCons_GL_Department_Id = CONS_GL_DEPARTMENT_ID,\n\t\tCurrent_Cons_GL_Department_Id = CONS_GL_DEPARTMENT_ID,\n\t\tCons_GL_Department = CONS_GL_DEPARTMENT,\n\t\tCurrent_Cons_GL_Department = CONS_GL_DEPARTMENT,\n\t\tCons_GL_Department_Name = CONS_GL_DEPARTMENT_NAME,\n\t\tCurrent_Cons_GL_Department_Name = CONS_GL_DEPARTMENT_NAME,\n\t\tCons_Department = CONS_DEPARTMENT,\n\t\tCurrent_Cons_Department = CONS_DEPARTMENT,\n\t\tHigh_Level_Department = HIGH_LEVEL_DEPARTMENT,\n\t\tCurrent_High_Level_Department = HIGH_LEVEL_DEPARTMENT,\n\t\tClass_Cat = CLASS_CAT_ID,\n\t\tCurrent_Class_Cat = CLASS_CAT_ID,\n\t\tClass = CLASS_CAT,\n\t\tCurrent_Class = CLASS_CAT,\n\t\tCategory_Id = CATEGORY_ID,\n\t\tCurrent_Category_Id = CATEGORY_ID,\n\t\tCategory = CATEGORY,\n\t\tCurrent_Category = CATEGORY,\n\t\tNew_Class = NEW_CLASS,\n\t\tCurrent_New_Class = NEW_CLASS,\n\t\tNew_Class_Category = NEW_CLASS_CATEGORY,\n\t\tCurrent_New_Class_Category = NEW_CLASS_CATEGORY,\n\t\tNew_Class_Subcategory = NEW_CLASS_SUBCATEGORY,\n\t\tCurrent_New_Class_Subcategory = NEW_CLASS_SUBCATEGORY,\n\t\tFamily_Code = FAMILY_CODE,\n\t\tCurrent_Family_Code = FAMILY_CODE,\n\t\tFamily_Name = FAMILY_NAME,\n\t\tCurrent_Family_Name = FAMILY_NAME,\n\t\tFamily_Id = FAMILY_ID,\n\t\tCurrent_Family_Id = FAMILY_ID,\n\t\tFamily = FAMILY,\n\t\tCurrent_Family = FAMILY,\n\t\tVendor_Id = VENDOR_ID,\n\t\tCurrent_Vendor_Id = VENDOR_ID,\n\t\tBrand_Name = BRAND_NAME,\n\t\tCurrent_Brand_Name = BRAND_NAME,\n\t\tAP_Vendor_Id = AP_VENDOR_ID,\n\t\tCurrent_AP_Vendor_Id = AP_VENDOR_ID,\n\t\tAP_Vendor_Name = AP_VENDOR_NAME,\n\t\tCurrent_AP_Vendor_Name = AP_VENDOR_NAME,\n\t\tAP_Vendor = AP_VENDOR,\n\t\tCurrent_AP_Vendor = AP_VENDOR,\n\t\tAP_Vendor_Address_Line_1 = AP_VENDOR_ADDRESS_LINE_1,\n\t\tCurrent_AP_Vendor_Address_Line_1 = AP_VENDOR_ADDRESS_LINE_1,\n\t\tAP_Vendor_Address_Line_2 = AP_VENDOR_ADDRESS_LINE_2,\n\t\tCurrent_AP_Vendor_Address_Line_2 = AP_VENDOR_ADDRESS_LINE_2,\n\t\tAP_Vendor_City = AP_VENDOR_CITY,\n\t\tCurrent_AP_Vendor_City = AP_VENDOR_CITY,\n\t\tAP_Vendor_Province = AP_VENDOR_PROVINCE,\n\t\tCurrent_AP_Vendor_Province = AP_VENDOR_PROVINCE,\n\t\tCorp_Brand_Description = CORP_BRAND_DESCRIPTION,\n\t\tCurrent_Corp_Brand_Description = CORP_BRAND_DESCRIPTION,\n\t\tCorp_Brand_Short_Description = CORP_BRAND_SHORT_DESCRIPTION,\n\t\tCurrent_Corp_Brand_Short_Description = CORP_BRAND_SHORT_DESCRIPTION,\n\t\tCorp_Brand_Indicator = CORP_BRAND_INDICATOR,\n\t\tCurrent_Corp_Brand_Indicator = CORP_BRAND_INDICATOR,\n\t\tCorp_Brand_Variant_Code = CORP_BRAND_VARIANT_CODE,\n\t\tCurrent_Corp_Brand_Variant_Code = CORP_BRAND_VARIANT_CODE,\n\t\tCorp_Brand_Shield = CORP_BRAND_SHIELD,\n\t\tCurrent_Corp_Brand_Shield = CORP_BRAND_SHIELD,\n\t\tCorp_Brand_Variant = CORP_BRAND_VARIANT,\n\t\tCurrent_Corp_Brand_Variant = CORP_BRAND_VARIANT,\n\t\tCorp_Brand_Variant_Name = CORP_BRAND_VARIANT_NAME,\n\t\tCurrent_Corp_Brand_Variant_Name = CORP_BRAND_VARIANT_NAME,\n\t\tDaymon = DAYMON,\n\t\tCurrent_Daymon = DAYMON,\n\t\tMerchandiser_Name = MERCHANDISER_NAME,\n\t\tCurrent_Merchandiser_Name = MERCHANDISER_NAME,\n\t\tMerchandiser_Number = MERCHANDISER_NUMBER,\n\t\tCurrent_Merchandiser_Number = MERCHANDISER_NUMBER,\n\t\tMerchandiser = MERCHANDISER,\n\t\tCurrent_Merchandiser = MERCHANDISER,\n\t\tSCPM,\n\t\tCurrent_SCPM = SCPM,\n\t\tGeneral_Manager = GENERAL_MANAGER,\n\t\tCurrent_General_Manager = GENERAL_MANAGER,\n\t\tVice_President = VICE_PRESIDENT,\n\t\tCurrent_Vice_President = VICE_PRESIDENT,\n\t\tCB_Director = CB_DIRECTOR,\n\t\tCurrent_CB_Director = CB_DIRECTOR,\n\t\tBusiness_Development_Manager = BUSINESS_DEVELOPMENT_MANAGER,\n\t\tCurrent_Business_Development_Manager = BUSINESS_DEVELOPMENT_MANAGER,\n\t\tListing_Date = o_Listing_Date,\n\t\tCurrent_Listing_Date = o_Listing_Date,\n\t\tDiscontinue_Date = DISCONTINUE_DATE,\n\t\tCurrent_Discontinue_Date = DISCONTINUE_DATE,\n\t\tDiscontinue_Reason = DISCONTINUE_REASON,\n\t\tCurrent_Discontinue_Reason = DISCONTINUE_REASON,\n\t\tFamily_Start_Date = o_Family_Start_Date,\n\t\tCurrent_Family_Start_Date = o_Family_Start_Date,\n\t\tFamily_End_Date = o_Family_End_Date,\n\t\tCurrent_Family_End_Date = o_Family_End_Date,\n\t\tSource_System_Code = SOURCE_SYSTEM_CODE,\n\t\tCurrent_Source_System_Code = SOURCE_SYSTEM_CODE,\n\t\tEff_Start_Dt = EFF_START_DT,\n\t\tEff_End_Dt = EFF_END_DT,\n\t\tIsActive,\n\t\tCrc_Val = CRCVAL,\n\t\tLast_Changed = LAST_CHANGED,\n\t\tLast_Dml = LAST_DML\n\t),\n\tpartitionBy('hash', 1)) ~> sinkNew\nDerivedColumn2 sink(allowSchemaDrift: true,\n\tvalidateSchema: true,\n\tinput(\n\t\tItem_Surrogate_Id as long,\n\t\tID as long,\n\t\tLegacy_Item_Code as integer,\n\t\tCurrent_Legacy_Item_Code as integer,\n\t\tVariant_Id as integer,\n\t\tCurrent_Variant_Id as integer,\n\t\tVariant_Name as string,\n\t\tCurrent_Variant_Name as string,\n\t\tVariant as string,\n\t\tCurrent_Variant as string,\n\t\tChinese_Variant as string,\n\t\tCurrent_Chinese_Variant as string,\n\t\tChinese_Variant_Name as string,\n\t\tCurrent_Chinese_Variant_Name as string,\n\t\tLead_Variant_Indicator as integer,\n\t\tCurrent_Lead_Variant_Indicator as integer,\n\t\tLead_Retail_Variant as integer,\n\t\tCurrent_Lead_Retail_Variant as integer,\n\t\tRetail_Size as string,\n\t\tCurrent_Retail_Size as string,\n\t\tRetail_Weight as double,\n\t\tCurrent_Retail_Weight as double,\n\t\tRetail_Pack as integer,\n\t\tCurrent_Retail_Pack as integer,\n\t\tProduct_Status as integer,\n\t\tCurrent_Product_Status as integer,\n\t\tOption_Code as integer,\n\t\tCurrent_Option_Code as integer,\n\t\tTax_Code as integer,\n\t\tCurrent_Tax_Code as integer,\n\t\tFinancial_Sale_Flag as string,\n\t\tCurrent_Financial_Sale_Flag as string,\n\t\tMerch_Sales_Flag as string,\n\t\tCurrent_Merch_Sales_Flag as string,\n\t\tStit as string,\n\t\tCurrent_Stit as string,\n\t\tDPack as string,\n\t\tCurrent_DPack as string,\n\t\tBasket_Type as string,\n\t\tCurrent_Basket_Type as string,\n\t\tStrategic_Group as string,\n\t\tCurrent_Strategic_Group as string,\n\t\tSell_Units as double,\n\t\tCurrent_Sell_Units as double,\n\t\tAmp_Forecast_Item as string,\n\t\tCurrent_Amp_Forecast_Item as string,\n\t\tRepack_Flag as string,\n\t\tCurrent_Repack_Flag as string,\n\t\tLast_Week_Ad_Type as string,\n\t\tCurrent_Last_Week_Ad_Type as string,\n\t\tStore_Report as string,\n\t\tCurrent_Store_Report as string,\n\t\tDepartment_Id as integer,\n\t\tCurrent_Department_Id as integer,\n\t\tDepartment_Name as string,\n\t\tCurrent_Department_Name as string,\n\t\tMerch_Department_Id as integer,\n\t\tCurrent_Merch_Department_Id as integer,\n\t\tMerch_Department as string,\n\t\tCurrent_Merch_Department as string,\n\t\tGL_Department_Id as integer,\n\t\tCurrent_GL_Department_Id as integer,\n\t\tGL_Department_Name as string,\n\t\tCurrent_GL_Department_Name as string,\n\t\tCons_GL_Department_Id as integer,\n\t\tCurrent_Cons_GL_Department_Id as integer,\n\t\tCons_GL_Department as string,\n\t\tCurrent_Cons_GL_Department as string,\n\t\tCons_GL_Department_Name as string,\n\t\tCurrent_Cons_GL_Department_Name as string,\n\t\tCons_Department as string,\n\t\tCurrent_Cons_Department as string,\n\t\tHigh_Level_Department as string,\n\t\tCurrent_High_Level_Department as string,\n\t\tClass_Cat as string,\n\t\tCurrent_Class_Cat as string,\n\t\tClass as string,\n\t\tCurrent_Class as string,\n\t\tCategory_Id as integer,\n\t\tCurrent_Category_Id as integer,\n\t\tCategory as string,\n\t\tCurrent_Category as string,\n\t\tNew_Class as string,\n\t\tCurrent_New_Class as string,\n\t\tNew_Class_Category as string,\n\t\tCurrent_New_Class_Category as string,\n\t\tNew_Class_Subcategory as string,\n\t\tCurrent_New_Class_Subcategory as string,\n\t\tFamily_Code as string,\n\t\tCurrent_Family_Code as string,\n\t\tFamily_Name as string,\n\t\tCurrent_Family_Name as string,\n\t\tFamily_Id as integer,\n\t\tCurrent_Family_Id as integer,\n\t\tFamily as string,\n\t\tCurrent_Family as string,\n\t\tVendor_Id as string,\n\t\tCurrent_Vendor_Id as string,\n\t\tBrand_Name as string,\n\t\tCurrent_Brand_Name as string,\n\t\tAP_Vendor_Id as string,\n\t\tCurrent_AP_Vendor_Id as string,\n\t\tAP_Vendor_Name as string,\n\t\tCurrent_AP_Vendor_Name as string,\n\t\tAP_Vendor as string,\n\t\tCurrent_AP_Vendor as string,\n\t\tAP_Vendor_Address_Line_1 as string,\n\t\tCurrent_AP_Vendor_Address_Line_1 as string,\n\t\tAP_Vendor_Address_Line_2 as string,\n\t\tCurrent_AP_Vendor_Address_Line_2 as string,\n\t\tAP_Vendor_City as string,\n\t\tCurrent_AP_Vendor_City as string,\n\t\tAP_Vendor_Province as string,\n\t\tCurrent_AP_Vendor_Province as string,\n\t\tCorp_Brand_Description as string,\n\t\tCurrent_Corp_Brand_Description as string,\n\t\tCorp_Brand_Short_Description as string,\n\t\tCurrent_Corp_Brand_Short_Description as string,\n\t\tCorp_Brand_Indicator as string,\n\t\tCurrent_Corp_Brand_Indicator as string,\n\t\tCorp_Brand_Variant_Code as string,\n\t\tCurrent_Corp_Brand_Variant_Code as string,\n\t\tCorp_Brand_Shield as string,\n\t\tCurrent_Corp_Brand_Shield as string,\n\t\tCorp_Brand_Variant as string,\n\t\tCurrent_Corp_Brand_Variant as string,\n\t\tCorp_Brand_Variant_Name as string,\n\t\tCurrent_Corp_Brand_Variant_Name as string,\n\t\tDaymon as string,\n\t\tCurrent_Daymon as string,\n\t\tMerchandiser_Name as string,\n\t\tCurrent_Merchandiser_Name as string,\n\t\tMerchandiser_Number as string,\n\t\tCurrent_Merchandiser_Number as string,\n\t\tMerchandiser as string,\n\t\tCurrent_Merchandiser as string,\n\t\tSCPM as string,\n\t\tCurrent_SCPM as string,\n\t\tGeneral_Manager as string,\n\t\tCurrent_General_Manager as string,\n\t\tVice_President as string,\n\t\tCurrent_Vice_President as string,\n\t\tCB_Director as string,\n\t\tCurrent_CB_Director as string,\n\t\tBusiness_Development_Manager as string,\n\t\tCurrent_Business_Development_Manager as string,\n\t\tListing_Date as date,\n\t\tCurrent_Listing_Date as date,\n\t\tDiscontinue_Date as string,\n\t\tCurrent_Discontinue_Date as string,\n\t\tDiscontinue_Reason as string,\n\t\tCurrent_Discontinue_Reason as string,\n\t\tFamily_Start_Date as date,\n\t\tCurrent_Family_Start_Date as date,\n\t\tFamily_End_Date as date,\n\t\tCurrent_Family_End_Date as date,\n\t\tSource_System_Code as string,\n\t\tCurrent_Source_System_Code as string,\n\t\tEff_Start_Dt as date,\n\t\tEff_End_Dt as date,\n\t\tIsActive as integer,\n\t\tCrc_Val as string,\n\t\tLast_Changed as string,\n\t\tLast_Dml as string\n\t),\n\tformat: 'parquet',\n\tpartitionFileNames:['ITEMDIMChangeExpiry.parquet'],\n\tsaveOrder: 0,\n\tmapColumn(\n\t\tItem_Surrogate_Id = TGT_Item_Surrogate_ID,\n\t\tID = TGT_ID,\n\t\tLegacy_Item_Code = TGT_LEGACY_ITEM_CODE,\n\t\tCurrent_Legacy_Item_Code = LEGACY_ITEM_CODE,\n\t\tVariant_Id = TGT_VARIANT_ID,\n\t\tCurrent_Variant_Id = VARIANT_ID,\n\t\tVariant_Name = TGT_VARIANT_NAME,\n\t\tCurrent_Variant_Name = VARIANT_NAME,\n\t\tVariant = TGT_VARIANT,\n\t\tCurrent_Variant = VARIANT,\n\t\tChinese_Variant = TGT_CHINESE_VARIANT,\n\t\tCurrent_Chinese_Variant = CHINESE_VARIANT,\n\t\tChinese_Variant_Name = TGT_CHINESE_VARIANT_NAME,\n\t\tCurrent_Chinese_Variant_Name = CHINESE_VARIANT_NAME,\n\t\tLead_Variant_Indicator = TGT_LEAD_VARIANT_INDICATOR,\n\t\tCurrent_Lead_Variant_Indicator = LEAD_VARIANT_INDICATOR,\n\t\tLead_Retail_Variant = TGT_LEAD_RETAIL_VARIANT,\n\t\tCurrent_Lead_Retail_Variant = LEAD_RETAIL_VARIANT,\n\t\tRetail_Size = TGT_RETAIL_SIZE,\n\t\tCurrent_Retail_Size = RETAIL_SIZE,\n\t\tRetail_Weight = TGT_RETAIL_WEIGHT,\n\t\tCurrent_Retail_Weight = RETAIL_WEIGHT,\n\t\tRetail_Pack = TGT_RETAIL_PACK,\n\t\tCurrent_Retail_Pack = RETAIL_PACK,\n\t\tProduct_Status = TGT_PRODUCT_STATUS,\n\t\tCurrent_Product_Status = PRODUCT_STATUS,\n\t\tOption_Code = TGT_OPTION_CODE,\n\t\tCurrent_Option_Code = OPTION_CODE,\n\t\tTax_Code = TGT_TAX_CODE,\n\t\tCurrent_Tax_Code = TAX_CODE,\n\t\tFinancial_Sale_Flag = TGT_FINANCIAL_SALE_FLAG,\n\t\tCurrent_Financial_Sale_Flag = FINANCIAL_SALE_FLAG,\n\t\tMerch_Sales_Flag = TGT_MERCH_SALES_FLAG,\n\t\tCurrent_Merch_Sales_Flag = MERCH_SALES_FLAG,\n\t\tStit = TGT_STIT,\n\t\tCurrent_Stit = STIT,\n\t\tDPack = TGT_DPACK,\n\t\tCurrent_DPack = DPACK,\n\t\tBasket_Type = TGT_BASKET_TYPE,\n\t\tCurrent_Basket_Type = BASKET_TYPE,\n\t\tStrategic_Group = TGT_STRATEGIC_GROUP,\n\t\tCurrent_Strategic_Group = STRATEGIC_GROUP,\n\t\tSell_Units = TGT_SELL_UNITS,\n\t\tCurrent_Sell_Units = SELL_UNITS,\n\t\tAmp_Forecast_Item = TGT_AMP_FORECAST_ITEM,\n\t\tCurrent_Amp_Forecast_Item = AMP_FORECAST_ITEM,\n\t\tRepack_Flag = TGT_REPACK_FLAG,\n\t\tCurrent_Repack_Flag = REPACK_FLAG,\n\t\tLast_Week_Ad_Type = TGT_LAST_WEEK_AD_TYPE,\n\t\tCurrent_Last_Week_Ad_Type = LAST_WEEK_AD_TYPE,\n\t\tStore_Report = TGT_STORE_REPORT,\n\t\tCurrent_Store_Report = STORE_REPORT,\n\t\tDepartment_Id = TGT_DEPARTMENT_ID,\n\t\tCurrent_Department_Id = DEPARTMENT_ID,\n\t\tDepartment_Name = TGT_DEPARTMENT_NAME,\n\t\tCurrent_Department_Name = DEPARTMENT_NAME,\n\t\tMerch_Department_Id = TGT_MERCH_DEPARTMENT_ID,\n\t\tCurrent_Merch_Department_Id = MERCH_DEPARTMENT_ID,\n\t\tMerch_Department = TGT_MERCH_DEPARTMENT,\n\t\tCurrent_Merch_Department = MERCH_DEPARTMENT,\n\t\tGL_Department_Id = TGT_GL_DEPARTMENT_ID,\n\t\tCurrent_GL_Department_Id = GL_DEPARTMENT_ID,\n\t\tGL_Department_Name = TGT_GL_DEPARTMENT_NAME,\n\t\tCurrent_GL_Department_Name = GL_DEPARTMENT_NAME,\n\t\tCons_GL_Department_Id = TGT_CONS_GL_DEPARTMENT_ID,\n\t\tCurrent_Cons_GL_Department_Id = CONS_GL_DEPARTMENT_ID,\n\t\tCons_GL_Department = TGT_CONS_GL_DEPARTMENT,\n\t\tCurrent_Cons_GL_Department = CONS_GL_DEPARTMENT,\n\t\tCons_GL_Department_Name = TGT_CONS_GL_DEPARTMENT_NAME,\n\t\tCurrent_Cons_GL_Department_Name = CONS_GL_DEPARTMENT_NAME,\n\t\tCons_Department = TGT_CONS_DEPARTMENT,\n\t\tCurrent_Cons_Department = CONS_DEPARTMENT,\n\t\tHigh_Level_Department = TGT_HIGH_LEVEL_DEPARTMENT,\n\t\tCurrent_High_Level_Department = HIGH_LEVEL_DEPARTMENT,\n\t\tClass_Cat = TGT_CLASS_CAT_ID,\n\t\tCurrent_Class_Cat = CLASS_CAT_ID,\n\t\tClass = TGT_CLASS_CAT,\n\t\tCurrent_Class = CLASS_CAT,\n\t\tCategory_Id = TGT_CATEGORY_ID,\n\t\tCurrent_Category_Id = CATEGORY_ID,\n\t\tCategory = TGT_CATEGORY,\n\t\tCurrent_Category = CATEGORY,\n\t\tNew_Class = TGT_NEW_CLASS,\n\t\tCurrent_New_Class = NEW_CLASS,\n\t\tNew_Class_Category = TGT_NEW_CLASS_CATEGORY,\n\t\tCurrent_New_Class_Category = NEW_CLASS_CATEGORY,\n\t\tNew_Class_Subcategory = TGT_NEW_CLASS_SUBCATEGORY,\n\t\tCurrent_New_Class_Subcategory = NEW_CLASS_SUBCATEGORY,\n\t\tFamily_Code = TGT_FAMILY_CODE,\n\t\tCurrent_Family_Code = FAMILY_CODE,\n\t\tFamily_Name = TGT_FAMILY_NAME,\n\t\tCurrent_Family_Name = FAMILY_NAME,\n\t\tFamily_Id = TGT_FAMILY_ID,\n\t\tCurrent_Family_Id = FAMILY_ID,\n\t\tFamily = TGT_FAMILY,\n\t\tCurrent_Family = FAMILY,\n\t\tVendor_Id = TGT_VENDOR_ID,\n\t\tCurrent_Vendor_Id = VENDOR_ID,\n\t\tBrand_Name = TGT_BRAND_NAME,\n\t\tCurrent_Brand_Name = BRAND_NAME,\n\t\tAP_Vendor_Id = TGT_AP_VENDOR_ID,\n\t\tCurrent_AP_Vendor_Id = AP_VENDOR_ID,\n\t\tAP_Vendor_Name = TGT_AP_VENDOR_NAME,\n\t\tCurrent_AP_Vendor_Name = AP_VENDOR_NAME,\n\t\tAP_Vendor = TGT_AP_VENDOR,\n\t\tCurrent_AP_Vendor = AP_VENDOR,\n\t\tAP_Vendor_Address_Line_1 = TGT_AP_VENDOR_ADDRESS_LINE_1,\n\t\tCurrent_AP_Vendor_Address_Line_1 = AP_VENDOR_ADDRESS_LINE_1,\n\t\tAP_Vendor_Address_Line_2 = TGT_AP_VENDOR_ADDRESS_LINE_2,\n\t\tCurrent_AP_Vendor_Address_Line_2 = AP_VENDOR_ADDRESS_LINE_2,\n\t\tAP_Vendor_City = TGT_AP_VENDOR_CITY,\n\t\tCurrent_AP_Vendor_City = AP_VENDOR_CITY,\n\t\tAP_Vendor_Province = TGT_AP_VENDOR_PROVINCE,\n\t\tCurrent_AP_Vendor_Province = AP_VENDOR_PROVINCE,\n\t\tCorp_Brand_Description = TGT_CORP_BRAND_DESCRIPTION,\n\t\tCurrent_Corp_Brand_Description = CORP_BRAND_DESCRIPTION,\n\t\tCorp_Brand_Short_Description = TGT_CORP_BRAND_SHORT_DESCRIPTION,\n\t\tCurrent_Corp_Brand_Short_Description = CORP_BRAND_SHORT_DESCRIPTION,\n\t\tCorp_Brand_Indicator = TGT_CORP_BRAND_INDICATOR,\n\t\tCurrent_Corp_Brand_Indicator = CORP_BRAND_INDICATOR,\n\t\tCorp_Brand_Variant_Code = TGT_CORP_BRAND_VARIANT_CODE,\n\t\tCurrent_Corp_Brand_Variant_Code = CORP_BRAND_VARIANT_CODE,\n\t\tCorp_Brand_Shield = TGT_CORP_BRAND_SHIELD,\n\t\tCurrent_Corp_Brand_Shield = CORP_BRAND_SHIELD,\n\t\tCorp_Brand_Variant = TGT_CORP_BRAND_VARIANT,\n\t\tCurrent_Corp_Brand_Variant = CORP_BRAND_VARIANT,\n\t\tCorp_Brand_Variant_Name = TGT_CORP_BRAND_VARIANT_NAME,\n\t\tCurrent_Corp_Brand_Variant_Name = CORP_BRAND_VARIANT_NAME,\n\t\tDaymon = TGT_DAYMON,\n\t\tCurrent_Daymon = DAYMON,\n\t\tMerchandiser_Name = TGT_MERCHANDISER_NAME,\n\t\tCurrent_Merchandiser_Name = MERCHANDISER_NAME,\n\t\tMerchandiser_Number = TGT_MERCHANDISER_NUMBER,\n\t\tCurrent_Merchandiser_Number = MERCHANDISER_NUMBER,\n\t\tMerchandiser = TGT_MERCHANDISER,\n\t\tCurrent_Merchandiser = MERCHANDISER,\n\t\tSCPM = TGT_SCPM,\n\t\tCurrent_SCPM = SCPM,\n\t\tGeneral_Manager = TGT_GENERAL_MANAGER,\n\t\tCurrent_General_Manager = GENERAL_MANAGER,\n\t\tVice_President = TGT_VICE_PRESIDENT,\n\t\tCurrent_Vice_President = VICE_PRESIDENT,\n\t\tCB_Director = TGT_CB_DIRECTOR,\n\t\tCurrent_CB_Director = CB_DIRECTOR,\n\t\tBusiness_Development_Manager = TGT_BUSINESS_DEVELOPMENT_MANAGER,\n\t\tCurrent_Business_Development_Manager = BUSINESS_DEVELOPMENT_MANAGER,\n\t\tListing_Date = TGT_LISTING_DATE,\n\t\tCurrent_Listing_Date = o_Listing_Date,\n\t\tDiscontinue_Date = TGT_DISCONTINUE_DATE,\n\t\tCurrent_Discontinue_Date = DISCONTINUE_DATE,\n\t\tDiscontinue_Reason = TGT_DISCONTINUE_REASON,\n\t\tCurrent_Discontinue_Reason = DISCONTINUE_REASON,\n\t\tFamily_Start_Date = TGT_FAMILY_START_DATE,\n\t\tCurrent_Family_Start_Date = o_Family_Start_Date,\n\t\tFamily_End_Date = TGT_FAMILY_END_DATE,\n\t\tCurrent_Family_End_Date = o_Family_End_Date,\n\t\tSource_System_Code = TGT_SOURCE_SYSTEM_CODE,\n\t\tCurrent_Source_System_Code = SOURCE_SYSTEM_CODE,\n\t\tEff_Start_Dt = TGT_EFF_START_DT,\n\t\tEff_End_Dt = final_EFF_END_DT,\n\t\tIsActive = Inactive,\n\t\tCrc_Val = TGT_CRC_VAL,\n\t\tLast_Changed = TGT_LAST_CHANGED,\n\t\tLast_Dml = TGT_LAST_DML\n\t),\n\tpartitionBy('hash', 1)) ~> sinkExpiry\nDerivedColumn3 sink(allowSchemaDrift: true,\n\tvalidateSchema: true,\n\tinput(\n\t\tItem_Surrogate_Id as long,\n\t\tID as long,\n\t\tLegacy_Item_Code as integer,\n\t\tCurrent_Legacy_Item_Code as integer,\n\t\tVariant_Id as integer,\n\t\tCurrent_Variant_Id as integer,\n\t\tVariant_Name as string,\n\t\tCurrent_Variant_Name as string,\n\t\tVariant as string,\n\t\tCurrent_Variant as string,\n\t\tChinese_Variant as string,\n\t\tCurrent_Chinese_Variant as string,\n\t\tChinese_Variant_Name as string,\n\t\tCurrent_Chinese_Variant_Name as string,\n\t\tLead_Variant_Indicator as integer,\n\t\tCurrent_Lead_Variant_Indicator as integer,\n\t\tLead_Retail_Variant as integer,\n\t\tCurrent_Lead_Retail_Variant as integer,\n\t\tRetail_Size as string,\n\t\tCurrent_Retail_Size as string,\n\t\tRetail_Weight as double,\n\t\tCurrent_Retail_Weight as double,\n\t\tRetail_Pack as integer,\n\t\tCurrent_Retail_Pack as integer,\n\t\tProduct_Status as integer,\n\t\tCurrent_Product_Status as integer,\n\t\tOption_Code as integer,\n\t\tCurrent_Option_Code as integer,\n\t\tTax_Code as integer,\n\t\tCurrent_Tax_Code as integer,\n\t\tFinancial_Sale_Flag as string,\n\t\tCurrent_Financial_Sale_Flag as string,\n\t\tMerch_Sales_Flag as string,\n\t\tCurrent_Merch_Sales_Flag as string,\n\t\tStit as string,\n\t\tCurrent_Stit as string,\n\t\tDPack as string,\n\t\tCurrent_DPack as string,\n\t\tBasket_Type as string,\n\t\tCurrent_Basket_Type as string,\n\t\tStrategic_Group as string,\n\t\tCurrent_Strategic_Group as string,\n\t\tSell_Units as double,\n\t\tCurrent_Sell_Units as double,\n\t\tAmp_Forecast_Item as string,\n\t\tCurrent_Amp_Forecast_Item as string,\n\t\tRepack_Flag as string,\n\t\tCurrent_Repack_Flag as string,\n\t\tLast_Week_Ad_Type as string,\n\t\tCurrent_Last_Week_Ad_Type as string,\n\t\tStore_Report as string,\n\t\tCurrent_Store_Report as string,\n\t\tDepartment_Id as integer,\n\t\tCurrent_Department_Id as integer,\n\t\tDepartment_Name as string,\n\t\tCurrent_Department_Name as string,\n\t\tMerch_Department_Id as integer,\n\t\tCurrent_Merch_Department_Id as integer,\n\t\tMerch_Department as string,\n\t\tCurrent_Merch_Department as string,\n\t\tGL_Department_Id as integer,\n\t\tCurrent_GL_Department_Id as integer,\n\t\tGL_Department_Name as string,\n\t\tCurrent_GL_Department_Name as string,\n\t\tCons_GL_Department_Id as integer,\n\t\tCurrent_Cons_GL_Department_Id as integer,\n\t\tCons_GL_Department as string,\n\t\tCurrent_Cons_GL_Department as string,\n\t\tCons_GL_Department_Name as string,\n\t\tCurrent_Cons_GL_Department_Name as string,\n\t\tCons_Department as string,\n\t\tCurrent_Cons_Department as string,\n\t\tHigh_Level_Department as string,\n\t\tCurrent_High_Level_Department as string,\n\t\tClass_Cat as string,\n\t\tCurrent_Class_Cat as string,\n\t\tClass as string,\n\t\tCurrent_Class as string,\n\t\tCategory_Id as integer,\n\t\tCurrent_Category_Id as integer,\n\t\tCategory as string,\n\t\tCurrent_Category as string,\n\t\tNew_Class as string,\n\t\tCurrent_New_Class as string,\n\t\tNew_Class_Category as string,\n\t\tCurrent_New_Class_Category as string,\n\t\tNew_Class_Subcategory as string,\n\t\tCurrent_New_Class_Subcategory as string,\n\t\tFamily_Code as string,\n\t\tCurrent_Family_Code as string,\n\t\tFamily_Name as string,\n\t\tCurrent_Family_Name as string,\n\t\tFamily_Id as integer,\n\t\tCurrent_Family_Id as integer,\n\t\tFamily as string,\n\t\tCurrent_Family as string,\n\t\tVendor_Id as string,\n\t\tCurrent_Vendor_Id as string,\n\t\tBrand_Name as string,\n\t\tCurrent_Brand_Name as string,\n\t\tAP_Vendor_Id as string,\n\t\tCurrent_AP_Vendor_Id as string,\n\t\tAP_Vendor_Name as string,\n\t\tCurrent_AP_Vendor_Name as string,\n\t\tAP_Vendor as string,\n\t\tCurrent_AP_Vendor as string,\n\t\tAP_Vendor_Address_Line_1 as string,\n\t\tCurrent_AP_Vendor_Address_Line_1 as string,\n\t\tAP_Vendor_Address_Line_2 as string,\n\t\tCurrent_AP_Vendor_Address_Line_2 as string,\n\t\tAP_Vendor_City as string,\n\t\tCurrent_AP_Vendor_City as string,\n\t\tAP_Vendor_Province as string,\n\t\tCurrent_AP_Vendor_Province as string,\n\t\tCorp_Brand_Description as string,\n\t\tCurrent_Corp_Brand_Description as string,\n\t\tCorp_Brand_Short_Description as string,\n\t\tCurrent_Corp_Brand_Short_Description as string,\n\t\tCorp_Brand_Indicator as string,\n\t\tCurrent_Corp_Brand_Indicator as string,\n\t\tCorp_Brand_Variant_Code as string,\n\t\tCurrent_Corp_Brand_Variant_Code as string,\n\t\tCorp_Brand_Shield as string,\n\t\tCurrent_Corp_Brand_Shield as string,\n\t\tCorp_Brand_Variant as string,\n\t\tCurrent_Corp_Brand_Variant as string,\n\t\tCorp_Brand_Variant_Name as string,\n\t\tCurrent_Corp_Brand_Variant_Name as string,\n\t\tDaymon as string,\n\t\tCurrent_Daymon as string,\n\t\tMerchandiser_Name as string,\n\t\tCurrent_Merchandiser_Name as string,\n\t\tMerchandiser_Number as string,\n\t\tCurrent_Merchandiser_Number as string,\n\t\tMerchandiser as string,\n\t\tCurrent_Merchandiser as string,\n\t\tSCPM as string,\n\t\tCurrent_SCPM as string,\n\t\tGeneral_Manager as string,\n\t\tCurrent_General_Manager as string,\n\t\tVice_President as string,\n\t\tCurrent_Vice_President as string,\n\t\tCB_Director as string,\n\t\tCurrent_CB_Director as string,\n\t\tBusiness_Development_Manager as string,\n\t\tCurrent_Business_Development_Manager as string,\n\t\tListing_Date as date,\n\t\tCurrent_Listing_Date as date,\n\t\tDiscontinue_Date as string,\n\t\tCurrent_Discontinue_Date as string,\n\t\tDiscontinue_Reason as string,\n\t\tCurrent_Discontinue_Reason as string,\n\t\tFamily_Start_Date as date,\n\t\tCurrent_Family_Start_Date as date,\n\t\tFamily_End_Date as date,\n\t\tCurrent_Family_End_Date as date,\n\t\tSource_System_Code as string,\n\t\tCurrent_Source_System_Code as string,\n\t\tEff_Start_Dt as date,\n\t\tEff_End_Dt as date,\n\t\tIsActive as integer,\n\t\tCrc_Val as string,\n\t\tLast_Changed as string,\n\t\tLast_Dml as string\n\t),\n\tformat: 'parquet',\n\tpartitionFileNames:['ITEMDIMNoChange.parquet'],\n\tsaveOrder: 0,\n\tmapColumn(\n\t\tItem_Surrogate_Id = TGT_Item_Surrogate_ID,\n\t\tID = TGT_ID,\n\t\tLegacy_Item_Code = TGT_LEGACY_ITEM_CODE,\n\t\tCurrent_Legacy_Item_Code = TGT_Current_LEGACY_ITEM_CODE,\n\t\tVariant_Id = TGT_VARIANT_ID,\n\t\tCurrent_Variant_Id = TGT_Current_VARIANT_ID,\n\t\tVariant_Name = TGT_VARIANT_NAME,\n\t\tCurrent_Variant_Name = TGT_Current_VARIANT_NAME,\n\t\tVariant = TGT_VARIANT,\n\t\tCurrent_Variant = TGT_Current_VARIANT,\n\t\tChinese_Variant = TGT_CHINESE_VARIANT,\n\t\tCurrent_Chinese_Variant = TGT_Current_CHINESE_VARIANT,\n\t\tChinese_Variant_Name = TGT_CHINESE_VARIANT_NAME,\n\t\tCurrent_Chinese_Variant_Name = TGT_Current_CHINESE_VARIANT_NAME,\n\t\tLead_Variant_Indicator = TGT_LEAD_VARIANT_INDICATOR,\n\t\tCurrent_Lead_Variant_Indicator = TGT_Current_LEAD_VARIANT_INDICATOR,\n\t\tLead_Retail_Variant = TGT_LEAD_RETAIL_VARIANT,\n\t\tCurrent_Lead_Retail_Variant = TGT_Current_LEAD_RETAIL_VARIANT,\n\t\tRetail_Size = TGT_RETAIL_SIZE,\n\t\tCurrent_Retail_Size = TGT_Current_RETAIL_SIZE,\n\t\tRetail_Weight = TGT_RETAIL_WEIGHT,\n\t\tCurrent_Retail_Weight = TGT_Current_RETAIL_WEIGHT,\n\t\tRetail_Pack = TGT_RETAIL_PACK,\n\t\tCurrent_Retail_Pack = TGT_Current_RETAIL_PACK,\n\t\tProduct_Status = TGT_PRODUCT_STATUS,\n\t\tCurrent_Product_Status = TGT_Current_PRODUCT_STATUS,\n\t\tOption_Code = TGT_OPTION_CODE,\n\t\tCurrent_Option_Code = TGT_Current_OPTION_CODE,\n\t\tTax_Code = TGT_TAX_CODE,\n\t\tCurrent_Tax_Code = TGT_Current_TAX_CODE,\n\t\tFinancial_Sale_Flag = TGT_FINANCIAL_SALE_FLAG,\n\t\tCurrent_Financial_Sale_Flag = TGT_Current_FINANCIAL_SALE_FLAG,\n\t\tMerch_Sales_Flag = TGT_MERCH_SALES_FLAG,\n\t\tCurrent_Merch_Sales_Flag = TGT_Current_MERCH_SALES_FLAG,\n\t\tStit = TGT_STIT,\n\t\tCurrent_Stit = TGT_Current_STIT,\n\t\tDPack = TGT_DPACK,\n\t\tCurrent_DPack = TGT_Current_DPACK,\n\t\tBasket_Type = TGT_BASKET_TYPE,\n\t\tCurrent_Basket_Type = TGT_Current_BASKET_TYPE,\n\t\tStrategic_Group = TGT_STRATEGIC_GROUP,\n\t\tCurrent_Strategic_Group = TGT_Current_STRATEGIC_GROUP,\n\t\tSell_Units = TGT_SELL_UNITS,\n\t\tCurrent_Sell_Units = TGT_Current_SELL_UNITS,\n\t\tAmp_Forecast_Item = TGT_AMP_FORECAST_ITEM,\n\t\tCurrent_Amp_Forecast_Item = TGT_Current_AMP_FORECAST_ITEM,\n\t\tRepack_Flag = TGT_REPACK_FLAG,\n\t\tCurrent_Repack_Flag = TGT_Current_REPACK_FLAG,\n\t\tLast_Week_Ad_Type = TGT_LAST_WEEK_AD_TYPE,\n\t\tCurrent_Last_Week_Ad_Type = TGT_Current_LAST_WEEK_AD_TYPE,\n\t\tStore_Report = TGT_STORE_REPORT,\n\t\tCurrent_Store_Report = TGT_Current_STORE_REPORT,\n\t\tDepartment_Id = TGT_DEPARTMENT_ID,\n\t\tCurrent_Department_Id = TGT_Current_DEPARTMENT_ID,\n\t\tDepartment_Name = TGT_DEPARTMENT_NAME,\n\t\tCurrent_Department_Name = TGT_Current_DEPARTMENT_NAME,\n\t\tMerch_Department_Id = TGT_MERCH_DEPARTMENT_ID,\n\t\tCurrent_Merch_Department_Id = TGT_Current_MERCH_DEPARTMENT_ID,\n\t\tMerch_Department = TGT_MERCH_DEPARTMENT,\n\t\tCurrent_Merch_Department = TGT_Current_MERCH_DEPARTMENT,\n\t\tGL_Department_Id = TGT_GL_DEPARTMENT_ID,\n\t\tCurrent_GL_Department_Id = TGT_Current_GL_DEPARTMENT_ID,\n\t\tGL_Department_Name = TGT_GL_DEPARTMENT_NAME,\n\t\tCurrent_GL_Department_Name = TGT_Current_GL_DEPARTMENT_NAME,\n\t\tCons_GL_Department_Id = TGT_CONS_GL_DEPARTMENT_ID,\n\t\tCurrent_Cons_GL_Department_Id = TGT_Current_CONS_GL_DEPARTMENT_ID,\n\t\tCons_GL_Department = TGT_CONS_GL_DEPARTMENT,\n\t\tCurrent_Cons_GL_Department = TGT_Current_CONS_GL_DEPARTMENT,\n\t\tCons_GL_Department_Name = TGT_CONS_GL_DEPARTMENT_NAME,\n\t\tCurrent_Cons_GL_Department_Name = TGT_Current_CONS_GL_DEPARTMENT_NAME,\n\t\tCons_Department = TGT_CONS_DEPARTMENT,\n\t\tCurrent_Cons_Department = TGT_Current_CONS_DEPARTMENT,\n\t\tHigh_Level_Department = TGT_HIGH_LEVEL_DEPARTMENT,\n\t\tCurrent_High_Level_Department = TGT_Current_HIGH_LEVEL_DEPARTMENT,\n\t\tClass_Cat = TGT_CLASS_CAT_ID,\n\t\tCurrent_Class_Cat = TGT_Current_CLASS_CAT_ID,\n\t\tClass = TGT_CLASS_CAT,\n\t\tCurrent_Class = TGT_Current_CLASS_CAT,\n\t\tCategory_Id = TGT_CATEGORY_ID,\n\t\tCurrent_Category_Id = TGT_Current_CATEGORY_ID,\n\t\tCategory = TGT_CATEGORY,\n\t\tCurrent_Category = TGT_Current_CATEGORY,\n\t\tNew_Class = TGT_NEW_CLASS,\n\t\tCurrent_New_Class = TGT_Current_CNEW_CLASS,\n\t\tNew_Class_Category = TGT_NEW_CLASS_CATEGORY,\n\t\tCurrent_New_Class_Category = TGT_Current_NEW_CLASS_CATEGORY,\n\t\tNew_Class_Subcategory = TGT_NEW_CLASS_SUBCATEGORY,\n\t\tCurrent_New_Class_Subcategory = TGT_Current_NEW_CLASS_SUBCATEGORY,\n\t\tFamily_Code = TGT_FAMILY_CODE,\n\t\tCurrent_Family_Code = TGT_Current_FAMILY_CODE,\n\t\tFamily_Name = TGT_FAMILY_NAME,\n\t\tCurrent_Family_Name = TGT_Current_FAMILY_NAME,\n\t\tFamily_Id = TGT_FAMILY_ID,\n\t\tCurrent_Family_Id = TGT_Current_FAMILY_ID,\n\t\tFamily = TGT_FAMILY,\n\t\tCurrent_Family = TGT_Current_FAMILY,\n\t\tVendor_Id = TGT_VENDOR_ID,\n\t\tCurrent_Vendor_Id = TGT_Current_VENDOR_ID,\n\t\tBrand_Name = TGT_BRAND_NAME,\n\t\tCurrent_Brand_Name = TGT_Current_BRAND_NAME,\n\t\tAP_Vendor_Id = TGT_AP_VENDOR_ID,\n\t\tCurrent_AP_Vendor_Id = TGT_Current_AP_VENDOR_ID,\n\t\tAP_Vendor_Name = TGT_AP_VENDOR_NAME,\n\t\tCurrent_AP_Vendor_Name = TGT_Current_AP_VENDOR_NAME,\n\t\tAP_Vendor = TGT_AP_VENDOR,\n\t\tCurrent_AP_Vendor = TGT_Current_AP_VENDOR,\n\t\tAP_Vendor_Address_Line_1 = TGT_AP_VENDOR_ADDRESS_LINE_1,\n\t\tCurrent_AP_Vendor_Address_Line_1 = TGT_Current_AP_VENDOR_ADDRESS_LINE_1,\n\t\tAP_Vendor_Address_Line_2 = TGT_AP_VENDOR_ADDRESS_LINE_2,\n\t\tCurrent_AP_Vendor_Address_Line_2 = TGT_Current_AP_VENDOR_ADDRESS_LINE_2,\n\t\tAP_Vendor_City = TGT_AP_VENDOR_CITY,\n\t\tCurrent_AP_Vendor_City = TGT_Current_AP_VENDOR_CITY,\n\t\tAP_Vendor_Province = TGT_AP_VENDOR_PROVINCE,\n\t\tCurrent_AP_Vendor_Province = TGT_Current_AP_VENDOR_PROVINCE,\n\t\tCorp_Brand_Description = TGT_CORP_BRAND_DESCRIPTION,\n\t\tCurrent_Corp_Brand_Description = TGT_Current_CORP_BRAND_DESCRIPTION,\n\t\tCorp_Brand_Short_Description = TGT_CORP_BRAND_SHORT_DESCRIPTION,\n\t\tCurrent_Corp_Brand_Short_Description = TGT_Current_CORP_BRAND_SHORT_DESCRIPTION,\n\t\tCorp_Brand_Indicator = TGT_CORP_BRAND_INDICATOR,\n\t\tCurrent_Corp_Brand_Indicator = TGT_Current_CORP_BRAND_INDICATOR,\n\t\tCorp_Brand_Variant_Code = TGT_CORP_BRAND_VARIANT_CODE,\n\t\tCurrent_Corp_Brand_Variant_Code = TGT_Current_CORP_BRAND_VARIANT_CODE,\n\t\tCorp_Brand_Shield = TGT_CORP_BRAND_SHIELD,\n\t\tCurrent_Corp_Brand_Shield = TGT_Current_CORP_BRAND_SHIELD,\n\t\tCorp_Brand_Variant = TGT_CORP_BRAND_VARIANT,\n\t\tCurrent_Corp_Brand_Variant = TGT_Current_CORP_BRAND_VARIANT,\n\t\tCorp_Brand_Variant_Name = TGT_CORP_BRAND_VARIANT_NAME,\n\t\tCurrent_Corp_Brand_Variant_Name = TGT_Current_CORP_BRAND_VARIANT_NAME,\n\t\tDaymon = TGT_DAYMON,\n\t\tCurrent_Daymon = TGT_Current_DAYMON,\n\t\tMerchandiser_Name = TGT_MERCHANDISER_NAME,\n\t\tCurrent_Merchandiser_Name = TGT_Current_MERCHANDISER_NAME,\n\t\tMerchandiser_Number = TGT_MERCHANDISER_NUMBER,\n\t\tCurrent_Merchandiser_Number = TGT_Current_MERCHANDISER_NUMBER,\n\t\tMerchandiser = TGT_MERCHANDISER,\n\t\tCurrent_Merchandiser = TGT_Current_MERCHANDISER,\n\t\tSCPM = TGT_SCPM,\n\t\tCurrent_SCPM = TGT_Current_SCPM,\n\t\tGeneral_Manager = TGT_GENERAL_MANAGER,\n\t\tCurrent_General_Manager = TGT_Current_GENERAL_MANAGER,\n\t\tVice_President = TGT_VICE_PRESIDENT,\n\t\tCurrent_Vice_President = TGT_Current_VICE_PRESIDENT,\n\t\tCB_Director = TGT_CB_DIRECTOR,\n\t\tCurrent_CB_Director = TGT_Current_CB_DIRECTOR,\n\t\tBusiness_Development_Manager = TGT_BUSINESS_DEVELOPMENT_MANAGER,\n\t\tCurrent_Business_Development_Manager = TGT_Current_BUSINESS_DEVELOPMENT_MANAGER,\n\t\tListing_Date = TGT_LISTING_DATE,\n\t\tCurrent_Listing_Date = TGT_Current_LISTING_DATE,\n\t\tDiscontinue_Date = TGT_DISCONTINUE_DATE,\n\t\tCurrent_Discontinue_Date = TGT_Current_DISCONTINUE_DATE,\n\t\tDiscontinue_Reason = TGT_DISCONTINUE_REASON,\n\t\tCurrent_Discontinue_Reason = TGT_Current_DISCONTINUE_REASON,\n\t\tFamily_Start_Date = TGT_FAMILY_START_DATE,\n\t\tCurrent_Family_Start_Date = TGT_Current_FAMILY_START_DATE,\n\t\tFamily_End_Date = TGT_FAMILY_END_DATE,\n\t\tCurrent_Family_End_Date = TGT_Current_FAMILY_END_DATE,\n\t\tSource_System_Code = TGT_SOURCE_SYSTEM_CODE,\n\t\tCurrent_Source_System_Code = TGT_Current_SOURCE_SYSTEM_CODE,\n\t\tEff_Start_Dt = TGT_EFF_START_DT,\n\t\tEff_End_Dt = del_EFF_END_DATE,\n\t\tIsActive = del_inactive,\n\t\tCrc_Val = TGT_CRC_VAL,\n\t\tLast_Changed = TGT_LAST_CHANGED,\n\t\tLast_Dml = del_LAST_DML\n\t),\n\tpartitionBy('hash', 1)) ~> sinkNoChange\nDerivedSCD2 sink(allowSchemaDrift: true,\n\tvalidateSchema: true,\n\tinput(\n\t\tItem_Surrogate_Id as long,\n\t\tID as long,\n\t\tLegacy_Item_Code as integer,\n\t\tCurrent_Legacy_Item_Code as integer,\n\t\tVariant_Id as integer,\n\t\tCurrent_Variant_Id as integer,\n\t\tVariant_Name as string,\n\t\tCurrent_Variant_Name as string,\n\t\tVariant as string,\n\t\tCurrent_Variant as string,\n\t\tChinese_Variant as string,\n\t\tCurrent_Chinese_Variant as string,\n\t\tChinese_Variant_Name as string,\n\t\tCurrent_Chinese_Variant_Name as string,\n\t\tLead_Variant_Indicator as integer,\n\t\tCurrent_Lead_Variant_Indicator as integer,\n\t\tLead_Retail_Variant as integer,\n\t\tCurrent_Lead_Retail_Variant as integer,\n\t\tRetail_Size as string,\n\t\tCurrent_Retail_Size as string,\n\t\tRetail_Weight as double,\n\t\tCurrent_Retail_Weight as double,\n\t\tRetail_Pack as integer,\n\t\tCurrent_Retail_Pack as integer,\n\t\tProduct_Status as integer,\n\t\tCurrent_Product_Status as integer,\n\t\tOption_Code as integer,\n\t\tCurrent_Option_Code as integer,\n\t\tTax_Code as integer,\n\t\tCurrent_Tax_Code as integer,\n\t\tFinancial_Sale_Flag as string,\n\t\tCurrent_Financial_Sale_Flag as string,\n\t\tMerch_Sales_Flag as string,\n\t\tCurrent_Merch_Sales_Flag as string,\n\t\tStit as string,\n\t\tCurrent_Stit as string,\n\t\tDPack as string,\n\t\tCurrent_DPack as string,\n\t\tBasket_Type as string,\n\t\tCurrent_Basket_Type as string,\n\t\tStrategic_Group as string,\n\t\tCurrent_Strategic_Group as string,\n\t\tSell_Units as double,\n\t\tCurrent_Sell_Units as double,\n\t\tAmp_Forecast_Item as string,\n\t\tCurrent_Amp_Forecast_Item as string,\n\t\tRepack_Flag as string,\n\t\tCurrent_Repack_Flag as string,\n\t\tLast_Week_Ad_Type as string,\n\t\tCurrent_Last_Week_Ad_Type as string,\n\t\tStore_Report as string,\n\t\tCurrent_Store_Report as string,\n\t\tDepartment_Id as integer,\n\t\tCurrent_Department_Id as integer,\n\t\tDepartment_Name as string,\n\t\tCurrent_Department_Name as string,\n\t\tMerch_Department_Id as integer,\n\t\tCurrent_Merch_Department_Id as integer,\n\t\tMerch_Department as string,\n\t\tCurrent_Merch_Department as string,\n\t\tGL_Department_Id as integer,\n\t\tCurrent_GL_Department_Id as integer,\n\t\tGL_Department_Name as string,\n\t\tCurrent_GL_Department_Name as string,\n\t\tCons_GL_Department_Id as integer,\n\t\tCurrent_Cons_GL_Department_Id as integer,\n\t\tCons_GL_Department as string,\n\t\tCurrent_Cons_GL_Department as string,\n\t\tCons_GL_Department_Name as string,\n\t\tCurrent_Cons_GL_Department_Name as string,\n\t\tCons_Department as string,\n\t\tCurrent_Cons_Department as string,\n\t\tHigh_Level_Department as string,\n\t\tCurrent_High_Level_Department as string,\n\t\tClass_Cat as string,\n\t\tCurrent_Class_Cat as string,\n\t\tClass as string,\n\t\tCurrent_Class as string,\n\t\tCategory_Id as integer,\n\t\tCurrent_Category_Id as integer,\n\t\tCategory as string,\n\t\tCurrent_Category as string,\n\t\tNew_Class as string,\n\t\tCurrent_New_Class as string,\n\t\tNew_Class_Category as string,\n\t\tCurrent_New_Class_Category as string,\n\t\tNew_Class_Subcategory as string,\n\t\tCurrent_New_Class_Subcategory as string,\n\t\tFamily_Code as string,\n\t\tCurrent_Family_Code as string,\n\t\tFamily_Name as string,\n\t\tCurrent_Family_Name as string,\n\t\tFamily_Id as integer,\n\t\tCurrent_Family_Id as integer,\n\t\tFamily as string,\n\t\tCurrent_Family as string,\n\t\tVendor_Id as string,\n\t\tCurrent_Vendor_Id as string,\n\t\tBrand_Name as string,\n\t\tCurrent_Brand_Name as string,\n\t\tAP_Vendor_Id as string,\n\t\tCurrent_AP_Vendor_Id as string,\n\t\tAP_Vendor_Name as string,\n\t\tCurrent_AP_Vendor_Name as string,\n\t\tAP_Vendor as string,\n\t\tCurrent_AP_Vendor as string,\n\t\tAP_Vendor_Address_Line_1 as string,\n\t\tCurrent_AP_Vendor_Address_Line_1 as string,\n\t\tAP_Vendor_Address_Line_2 as string,\n\t\tCurrent_AP_Vendor_Address_Line_2 as string,\n\t\tAP_Vendor_City as string,\n\t\tCurrent_AP_Vendor_City as string,\n\t\tAP_Vendor_Province as string,\n\t\tCurrent_AP_Vendor_Province as string,\n\t\tCorp_Brand_Description as string,\n\t\tCurrent_Corp_Brand_Description as string,\n\t\tCorp_Brand_Short_Description as string,\n\t\tCurrent_Corp_Brand_Short_Description as string,\n\t\tCorp_Brand_Indicator as string,\n\t\tCurrent_Corp_Brand_Indicator as string,\n\t\tCorp_Brand_Variant_Code as string,\n\t\tCurrent_Corp_Brand_Variant_Code as string,\n\t\tCorp_Brand_Shield as string,\n\t\tCurrent_Corp_Brand_Shield as string,\n\t\tCorp_Brand_Variant as string,\n\t\tCurrent_Corp_Brand_Variant as string,\n\t\tCorp_Brand_Variant_Name as string,\n\t\tCurrent_Corp_Brand_Variant_Name as string,\n\t\tDaymon as string,\n\t\tCurrent_Daymon as string,\n\t\tMerchandiser_Name as string,\n\t\tCurrent_Merchandiser_Name as string,\n\t\tMerchandiser_Number as string,\n\t\tCurrent_Merchandiser_Number as string,\n\t\tMerchandiser as string,\n\t\tCurrent_Merchandiser as string,\n\t\tSCPM as string,\n\t\tCurrent_SCPM as string,\n\t\tGeneral_Manager as string,\n\t\tCurrent_General_Manager as string,\n\t\tVice_President as string,\n\t\tCurrent_Vice_President as string,\n\t\tCB_Director as string,\n\t\tCurrent_CB_Director as string,\n\t\tBusiness_Development_Manager as string,\n\t\tCurrent_Business_Development_Manager as string,\n\t\tListing_Date as date,\n\t\tCurrent_Listing_Date as date,\n\t\tDiscontinue_Date as string,\n\t\tCurrent_Discontinue_Date as string,\n\t\tDiscontinue_Reason as string,\n\t\tCurrent_Discontinue_Reason as string,\n\t\tFamily_Start_Date as date,\n\t\tCurrent_Family_Start_Date as date,\n\t\tFamily_End_Date as date,\n\t\tCurrent_Family_End_Date as date,\n\t\tSource_System_Code as string,\n\t\tCurrent_Source_System_Code as string,\n\t\tEff_Start_Dt as date,\n\t\tEff_End_Dt as date,\n\t\tIsActive as integer,\n\t\tCrc_Val as string,\n\t\tLast_Changed as string,\n\t\tLast_Dml as string\n\t),\n\tformat: 'parquet',\n\tpartitionFileNames:['ITEMDIMSCD2.parquet'],\n\tmapColumn(\n\t\tItem_Surrogate_Id = out_SurrogateKey,\n\t\tID,\n\t\tLegacy_Item_Code = LEGACY_ITEM_CODE,\n\t\tCurrent_Legacy_Item_Code = LEGACY_ITEM_CODE,\n\t\tVariant_Id = VARIANT_ID,\n\t\tCurrent_Variant_Id = VARIANT_ID,\n\t\tVariant_Name = VARIANT_NAME,\n\t\tCurrent_Variant_Name = VARIANT_NAME,\n\t\tVariant = VARIANT,\n\t\tCurrent_Variant = VARIANT,\n\t\tChinese_Variant = CHINESE_VARIANT,\n\t\tCurrent_Chinese_Variant = CHINESE_VARIANT,\n\t\tChinese_Variant_Name = CHINESE_VARIANT_NAME,\n\t\tCurrent_Chinese_Variant_Name = CHINESE_VARIANT_NAME,\n\t\tLead_Variant_Indicator = LEAD_VARIANT_INDICATOR,\n\t\tCurrent_Lead_Variant_Indicator = LEAD_VARIANT_INDICATOR,\n\t\tLead_Retail_Variant = LEAD_RETAIL_VARIANT,\n\t\tCurrent_Lead_Retail_Variant = LEAD_RETAIL_VARIANT,\n\t\tRetail_Size = RETAIL_SIZE,\n\t\tCurrent_Retail_Size = RETAIL_SIZE,\n\t\tRetail_Weight = RETAIL_WEIGHT,\n\t\tCurrent_Retail_Weight = RETAIL_WEIGHT,\n\t\tRetail_Pack = RETAIL_PACK,\n\t\tCurrent_Retail_Pack = RETAIL_PACK,\n\t\tProduct_Status = PRODUCT_STATUS,\n\t\tCurrent_Product_Status = PRODUCT_STATUS,\n\t\tOption_Code = OPTION_CODE,\n\t\tCurrent_Option_Code = OPTION_CODE,\n\t\tTax_Code = TAX_CODE,\n\t\tCurrent_Tax_Code = TAX_CODE,\n\t\tFinancial_Sale_Flag = FINANCIAL_SALE_FLAG,\n\t\tCurrent_Financial_Sale_Flag = FINANCIAL_SALE_FLAG,\n\t\tMerch_Sales_Flag = MERCH_SALES_FLAG,\n\t\tCurrent_Merch_Sales_Flag = MERCH_SALES_FLAG,\n\t\tStit = STIT,\n\t\tCurrent_Stit = STIT,\n\t\tDPack = DPACK,\n\t\tCurrent_DPack = DPACK,\n\t\tBasket_Type = BASKET_TYPE,\n\t\tCurrent_Basket_Type = BASKET_TYPE,\n\t\tStrategic_Group = STRATEGIC_GROUP,\n\t\tCurrent_Strategic_Group = STRATEGIC_GROUP,\n\t\tSell_Units = SELL_UNITS,\n\t\tCurrent_Sell_Units = SELL_UNITS,\n\t\tAmp_Forecast_Item = AMP_FORECAST_ITEM,\n\t\tCurrent_Amp_Forecast_Item = AMP_FORECAST_ITEM,\n\t\tRepack_Flag = REPACK_FLAG,\n\t\tCurrent_Repack_Flag = REPACK_FLAG,\n\t\tLast_Week_Ad_Type = LAST_WEEK_AD_TYPE,\n\t\tCurrent_Last_Week_Ad_Type = LAST_WEEK_AD_TYPE,\n\t\tStore_Report = STORE_REPORT,\n\t\tCurrent_Store_Report = STORE_REPORT,\n\t\tDepartment_Id = DEPARTMENT_ID,\n\t\tCurrent_Department_Id = DEPARTMENT_ID,\n\t\tDepartment_Name = DEPARTMENT_NAME,\n\t\tCurrent_Department_Name = DEPARTMENT_NAME,\n\t\tMerch_Department_Id = MERCH_DEPARTMENT_ID,\n\t\tCurrent_Merch_Department_Id = MERCH_DEPARTMENT_ID,\n\t\tMerch_Department = MERCH_DEPARTMENT,\n\t\tCurrent_Merch_Department = MERCH_DEPARTMENT,\n\t\tGL_Department_Id = GL_DEPARTMENT_ID,\n\t\tCurrent_GL_Department_Id = GL_DEPARTMENT_ID,\n\t\tGL_Department_Name = GL_DEPARTMENT_NAME,\n\t\tCurrent_GL_Department_Name = GL_DEPARTMENT_NAME,\n\t\tCons_GL_Department_Id = CONS_GL_DEPARTMENT_ID,\n\t\tCurrent_Cons_GL_Department_Id = CONS_GL_DEPARTMENT_ID,\n\t\tCons_GL_Department = CONS_GL_DEPARTMENT,\n\t\tCurrent_Cons_GL_Department = CONS_GL_DEPARTMENT,\n\t\tCons_GL_Department_Name = CONS_GL_DEPARTMENT_NAME,\n\t\tCurrent_Cons_GL_Department_Name = CONS_GL_DEPARTMENT_NAME,\n\t\tCons_Department = CONS_DEPARTMENT,\n\t\tCurrent_Cons_Department = CONS_DEPARTMENT,\n\t\tHigh_Level_Department = HIGH_LEVEL_DEPARTMENT,\n\t\tCurrent_High_Level_Department = HIGH_LEVEL_DEPARTMENT,\n\t\tClass_Cat = CLASS_CAT_ID,\n\t\tCurrent_Class_Cat = CLASS_CAT_ID,\n\t\tClass = CLASS_CAT,\n\t\tCurrent_Class = CLASS_CAT,\n\t\tCategory_Id = CATEGORY_ID,\n\t\tCurrent_Category_Id = CATEGORY_ID,\n\t\tCategory = CATEGORY,\n\t\tCurrent_Category = CATEGORY,\n\t\tNew_Class = NEW_CLASS,\n\t\tCurrent_New_Class = NEW_CLASS,\n\t\tNew_Class_Category = NEW_CLASS_CATEGORY,\n\t\tCurrent_New_Class_Category = NEW_CLASS_CATEGORY,\n\t\tNew_Class_Subcategory = NEW_CLASS_SUBCATEGORY,\n\t\tCurrent_New_Class_Subcategory = NEW_CLASS_SUBCATEGORY,\n\t\tFamily_Code = FAMILY_CODE,\n\t\tCurrent_Family_Code = FAMILY_CODE,\n\t\tFamily_Name = FAMILY_NAME,\n\t\tCurrent_Family_Name = FAMILY_NAME,\n\t\tFamily_Id = FAMILY_ID,\n\t\tCurrent_Family_Id = FAMILY_ID,\n\t\tFamily = FAMILY,\n\t\tCurrent_Family = FAMILY,\n\t\tVendor_Id = VENDOR_ID,\n\t\tCurrent_Vendor_Id = VENDOR_ID,\n\t\tBrand_Name = BRAND_NAME,\n\t\tCurrent_Brand_Name = BRAND_NAME,\n\t\tAP_Vendor_Id = AP_VENDOR_ID,\n\t\tCurrent_AP_Vendor_Id = AP_VENDOR_ID,\n\t\tAP_Vendor_Name = AP_VENDOR_NAME,\n\t\tCurrent_AP_Vendor_Name = AP_VENDOR_NAME,\n\t\tAP_Vendor = AP_VENDOR,\n\t\tCurrent_AP_Vendor = AP_VENDOR,\n\t\tAP_Vendor_Address_Line_1 = AP_VENDOR_ADDRESS_LINE_1,\n\t\tCurrent_AP_Vendor_Address_Line_1 = AP_VENDOR_ADDRESS_LINE_1,\n\t\tAP_Vendor_Address_Line_2 = AP_VENDOR_ADDRESS_LINE_2,\n\t\tCurrent_AP_Vendor_Address_Line_2 = AP_VENDOR_ADDRESS_LINE_2,\n\t\tAP_Vendor_City = AP_VENDOR_CITY,\n\t\tCurrent_AP_Vendor_City = AP_VENDOR_CITY,\n\t\tAP_Vendor_Province = AP_VENDOR_PROVINCE,\n\t\tCurrent_AP_Vendor_Province = AP_VENDOR_PROVINCE,\n\t\tCorp_Brand_Description = CORP_BRAND_DESCRIPTION,\n\t\tCurrent_Corp_Brand_Description = CORP_BRAND_DESCRIPTION,\n\t\tCorp_Brand_Short_Description = CORP_BRAND_SHORT_DESCRIPTION,\n\t\tCurrent_Corp_Brand_Short_Description = CORP_BRAND_SHORT_DESCRIPTION,\n\t\tCorp_Brand_Indicator = CORP_BRAND_INDICATOR,\n\t\tCurrent_Corp_Brand_Indicator = CORP_BRAND_INDICATOR,\n\t\tCorp_Brand_Variant_Code = CORP_BRAND_VARIANT_CODE,\n\t\tCurrent_Corp_Brand_Variant_Code = CORP_BRAND_VARIANT_CODE,\n\t\tCorp_Brand_Shield = CORP_BRAND_SHIELD,\n\t\tCurrent_Corp_Brand_Shield = CORP_BRAND_SHIELD,\n\t\tCorp_Brand_Variant = CORP_BRAND_VARIANT,\n\t\tCurrent_Corp_Brand_Variant = CORP_BRAND_VARIANT,\n\t\tCorp_Brand_Variant_Name = CORP_BRAND_VARIANT_NAME,\n\t\tCurrent_Corp_Brand_Variant_Name = CORP_BRAND_VARIANT_NAME,\n\t\tDaymon = DAYMON,\n\t\tCurrent_Daymon = DAYMON,\n\t\tMerchandiser_Name = MERCHANDISER_NAME,\n\t\tCurrent_Merchandiser_Name = MERCHANDISER_NAME,\n\t\tMerchandiser_Number = MERCHANDISER_NUMBER,\n\t\tCurrent_Merchandiser_Number = MERCHANDISER_NUMBER,\n\t\tMerchandiser = MERCHANDISER,\n\t\tCurrent_Merchandiser = MERCHANDISER,\n\t\tSCPM,\n\t\tCurrent_SCPM = SCPM,\n\t\tGeneral_Manager = GENERAL_MANAGER,\n\t\tCurrent_General_Manager = GENERAL_MANAGER,\n\t\tVice_President = VICE_PRESIDENT,\n\t\tCurrent_Vice_President = VICE_PRESIDENT,\n\t\tCB_Director = CB_DIRECTOR,\n\t\tCurrent_CB_Director = CB_DIRECTOR,\n\t\tBusiness_Development_Manager = BUSINESS_DEVELOPMENT_MANAGER,\n\t\tCurrent_Business_Development_Manager = BUSINESS_DEVELOPMENT_MANAGER,\n\t\tListing_Date = o_Listing_Date,\n\t\tCurrent_Listing_Date = o_Listing_Date,\n\t\tDiscontinue_Date = DISCONTINUE_DATE,\n\t\tCurrent_Discontinue_Date = DISCONTINUE_DATE,\n\t\tDiscontinue_Reason = DISCONTINUE_REASON,\n\t\tCurrent_Discontinue_Reason = DISCONTINUE_REASON,\n\t\tFamily_Start_Date = o_Family_Start_Date,\n\t\tCurrent_Family_Start_Date = o_Family_Start_Date,\n\t\tFamily_End_Date = o_Family_End_Date,\n\t\tCurrent_Family_End_Date = o_Family_End_Date,\n\t\tSource_System_Code = SOURCE_SYSTEM_CODE,\n\t\tCurrent_Source_System_Code = SOURCE_SYSTEM_CODE,\n\t\tEff_Start_Dt = scd_EFF_START_DT,\n\t\tEff_End_Dt = EFF_END_DT,\n\t\tIsActive,\n\t\tCrc_Val = CRCVAL,\n\t\tLast_Changed = LAST_CHANGED,\n\t\tLast_Dml = LAST_DML\n\t),\n\tpartitionBy('hash', 1)) ~> sinkSCD2"
		}
	}
}